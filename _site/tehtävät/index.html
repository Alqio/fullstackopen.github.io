<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>tehtävät</title>
  <meta name="description" content="">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://localhost:4000/teht%C3%A4v%C3%A4t/">
  <link rel="alternate" type="application/rss+xml" title="Full stack open 2018" href="/feed.xml">
  
  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    
    <a class="site-title" href="/">Full stack open 2018</a>
  
    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
        </div>
      </nav>
    
  </div>
</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">tehtävät</h1>
  </header>

  <div class="post-content">
    <h1 id="tehtävät">tehtävät</h1>

<ul>
  <li><a href="#osa-0">osa0</a> deadline 30.1. klo 23:59</li>
  <li><a href="#osa-1">osa1</a> deadline 30.1. klo 23:59</li>
  <li><a href="#osa-2">osa2</a> deadline 5.2. klo 23:59</li>
  <li><a href="#osa-3">osa3</a> deadline 12.2. klo 23:59</li>
  <li><a href="#osa-4">osa4</a> deadline 25.2. klo 23:59</li>
  <li><a href="#osa-5">osa5</a> deadline 4.3. klo 23:59</li>
  <li><a href="#osa-6">osa6</a> deadline 11.3. klo 23:59</li>
  <li><a href="#osa-7">osa7</a> deadline 11.3. klo 23:59</li>
</ul>

<h2 id="pakolliset-tehtävät-ja-tehtävien-vaikuttaminen-arvosteluun">Pakolliset tehtävät ja tehtävien vaikuttaminen arvosteluun</h2>

<p>Osa tehtävistä on “pakollisia” ja osa vapaaehtoisia. Vapaaehtoiset on merkattu tähdellä. Pakolliset eivät ole absoluuttisen pakollisia, mutta niiden tekemättä jättäminen saattaa aiheuttaa haasteita seuraaviin osiin.</p>

<p>Arvosananja opintopistemäärä lasketaan <em>kaikkien</em> tehtävien summan perusteella. Katso tarkemmin osan 0 luvut <a href="/osa0#suoritustapa">suoritustapa</a> ja <a href="/osa0#arvosteluperusteet">arvosteluperusteet</a>. Vain deadlineja ennen tehdyt ja merkatut tehtävät huomioidaan arvostelussa.</p>

<h2 id="arvosanarajat">Arvosanarajat</h2>

<p>Kurssilla on yhteensä 149 tehtävää. Tehtävien maksimimääräksi lasketaan kuitenkin 141, sillä osan 7 tehtävistä kaikki eivät vaikuta arvosteluun.</p>

<p>Arvosanarajat:</p>

<table>
  <thead>
    <tr>
      <th>tehtävää   </th>
      <th style="text-align: center">arvosana </th>
      <th style="text-align: center">op</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>70</td>
      <td style="text-align: center">1/5</td>
      <td style="text-align: center">5</td>
    </tr>
    <tr>
      <td>81</td>
      <td style="text-align: center">2/5</td>
      <td style="text-align: center">5</td>
    </tr>
    <tr>
      <td>92</td>
      <td style="text-align: center">3/5</td>
      <td style="text-align: center">5</td>
    </tr>
    <tr>
      <td>103</td>
      <td style="text-align: center">4/5</td>
      <td style="text-align: center">5</td>
    </tr>
    <tr>
      <td>113</td>
      <td style="text-align: center">5/5</td>
      <td style="text-align: center">5</td>
    </tr>
    <tr>
      <td>124</td>
      <td style="text-align: center">hyv</td>
      <td style="text-align: center">6</td>
    </tr>
    <tr>
      <td>134</td>
      <td style="text-align: center">hyv</td>
      <td style="text-align: center">7</td>
    </tr>
  </tbody>
</table>

<p>Ylimääräiset opintopisteet tullaan kirjaamaan kaikille arvosanalla “hyväksytty”.</p>

<h2 id="palauttaminen">Palauttaminen</h2>

<p>Olethan lukenut huolellisesti kurssimateriaalin osan 0 luvun <a href="/osa0/#Suoritustapa">Suoritustapa</a>?</p>

<p>Tehtävät palautetaan GitHubin kautta ja merkitsemällä tehdyt tehtävät <a href="https://studies.cs.helsinki.fi/fs-stats/">palautussovellukseen</a>.</p>

<p>Jos palautat eri osien tehtäviä samaan repositorioon, käytä järkevää hakemistojen nimentää.</p>

<p>Tehtävät palautetaan yksi osa kerrallaan. Kun olet palauttanut osan tehtävät, et voi enää palauttaa saman osan tekemättä jättämiäsi tehtäviä.</p>

<p>GitHubiin palautettuja tehtäviä tarkastetaan pistokokein. Jos GitHubista löytyy kurssin mallivastausten koodia tai useammalta opiskelijalta löytyy samaa koodia, käsitellään tilanne yliopiston <a href="http://blogs.helsinki.fi/alakopsaa/opettajalle/epailen-opiskelijaa-vilpista-mita-tehda/">vilppikäytäntöjen</a> mukaan.</p>

<p>Suurin osa tehtävistä on moniosaisia, samaa ohjelmaa pala palalta rakentavia kokonaisuuksia. Tälläisissä tehtäväsarjoissa ohjelman lopullisen version palauttaminen riittää, voit toki halutessasi tehdä commitin jokaisen tehtävän jälkeisestä tilanteesta, mutta se ei ole välttämätöntä.</p>

<h2 id="osa-0">Osa 0</h2>

<p>Deadline 30.1. klo 23:59</p>

<p>Osassa on 6 tehtävää joista kaikki ovat pakollisia. Voit edetä osaan 1 vasta tehtävät palautettuasi.</p>

<h3 id="web-sovellusten-perusteet">web-sovellusten perusteet</h3>

<h4 id="01-html-ja-css">0.1 HTML ja CSS</h4>

<p>Kertaa HTML:n ja CSS:n perusteet lukemalla Mozillan tutoriaalit <a href="https://developer.mozilla.org/en-US/docs/Learn/Getting_started_with_the_web/HTML_basics">HTML:stä</a> ja <a href="https://developer.mozilla.org/en-US/docs/Learn/Getting_started_with_the_web/CSS_basics">CSS:stä</a>.</p>

<h4 id="02-htmln-lomakkeet">0.2 HTML:n lomakkeet</h4>

<p>Tutustu HTML:n lomakkeiden perusteisiin lukemalla Mozillan tutoriaali <a href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Forms/Your_first_HTML_form">Your first form</a>.</p>

<h4 id="03-muistiinpanojen-sivu">0.3 muistiinpanojen sivu</h4>

<p>Kun käyttäjä menee selaimella osoitteeseen <a href="https://fullstack-exampleapp.herokuapp.com/">https://fullstack-exampleapp.herokuapp.com/</a> voidaan sen seurauksena olevaa tapahtumaketjua kuvata <a href="https://en.wikipedia.org/wiki/Sequence_diagram">sekvenssikaaviona</a> esim. seuraavasti:</p>

<p><img src="/assets/teht/1.png" height="400" /></p>

<p>Kaavio on luotu <a href="https://www.websequencediagrams.com">websequencediagrams</a>-palvelussa, seuraavasti:</p>

<pre>
kayttaja-&gt;selain:
note left of selain
kayttaja kirjottaa osoiteriville
fullstack-exampleapp.herokuapp.com
end note
selain-&gt;palvelin: GET fullstack-exampleapp.herokuapp.com
note left of palvelin
  muodostetaan HTML missä olemassaolevien
  muistiinpanojen lukumäärä päivitettynä
end note
palvelin-&gt;selain: status 200, sivun HTML-koodi

selain-&gt;palvelin: GET fullstack-exampleapp.herokuapp.com/kuva.png
palvelin-&gt;selain: status 200, kuva

note left of selain
 selain näyttää palvelimen palauttaman HTML:n
 johon on upotettu palvelimelta haettu kuva
end note
</pre>

<p><strong>Tee vastaavanlainen kaavio, joka kuvaa mitä tapahtuu kun käyttäjä navigoi muistiinpanojen sivulle</strong> eli urliin <a href="https://fullstack-exampleapp.herokuapp.com/notes">https://fullstack-exampleapp.herokuapp.com/notes</a></p>

<p>Kaavion ei ole pakko olla sekvenssikaavio. Mikä tahansa järkevä kuvaustapa käy.</p>

<p>Kaikki oleellinen tämän ja seuraavien kolmen tehtävän tekemiseen liittyvä informaatio on selitettynä <a href="../osa0">osan 0</a> tekstissä. Näiden tehtävien ideana on, että luet tekstin vielä kerran ja mietit tarkkaan mitä missäkin tapahtuu. Ohjelman <a href="https://github.com/mluukkai/example_app">koodin</a> lukemista ei näissä tehtävissä edellytetä, vaikka sekin on toki mahdollista.</p>

<h4 id="04-uusi-muistiinpano">0.4 Uusi muistiinpano</h4>

<p>Tee kaavio tilanteesta, missä käyttäjä luo uuden muistiinpanon ollessaan sivulla <a href="https://fullstack-exampleapp.herokuapp.com/notes">https://fullstack-exampleapp.herokuapp.com/notes</a>, eli kirjoittaa tekstikenttään jotain ja painaa nappia <em>tallenna</em></p>

<p>Kirjoita tarvittaessa palvelimella tai selaimessa tapahtuvat operaatiot sopivina kommentteina kaavion sekaan.</p>

<h4 id="05-single-page-app">0.5 Single page app</h4>

<p>Tee kaavio tilanteesta, missä käyttäjä menee selaimella osoitteeseen <a href="https://fullstack-exampleapp.herokuapp.com/spa">https://fullstack-exampleapp.herokuapp.com/spa</a> eli muistiinpanojen <a href="../osa0/#single-page-app">single page app</a>-versioon</p>

<h4 id="06-uusi-muistiinpano-spassa">0.6 Uusi muistiinpano SPA:ssa</h4>

<p>Tee kaavio tilanteesta, missä käyttäjä luo uuden muistiinpanon single page -versiossa.</p>

<h3 id="tehtävien-palautus">Tehtävien palautus</h3>

<p>Palauta tehtävät <a href="https://studies.cs.helsinki.fi/fs-stats/">palautussovellukseen</a>.</p>

<h2 id="osa-1">Osa 1</h2>

<p>Deadline 30.1. klo 23:59</p>

<p>Osassa on 14 tehtävää, joista pakollisia on 9. Voit edetä osaan 2 kun olet tehnyt kaikki pakolliset tehtävät. Palautuksen tekemisen jälkeen et voi enää palauttaa osan tehtäviä.</p>

<p>Osa sisältää muutaman tehtäväsarjan, joissa yksittäistä ohjelmaa laajennetaan pala palalta. Ohjelmien lopullisen version palauttaminen riittää, voit toki halutessasi tehdä commitin jokaisen tehtävän jälkeisestä tilanteesta, mutta se ei ole välttämätöntä.</p>

<div class="important">

<p>Ennen kun teet tehtäviä, on enemmän kuin suositeltavaa, että käyt huolellisesti läpi <a href="https://fullstack-hy.github.io/osa1/">osan 1 materiaalin</a>. Tehtävien tekeminen ilman materiaalin lukemista tapahtuu täysin omalla vastuulla.</p>

</div>

<h3 id="reactin-alkeet">reactin alkeet</h3>

<h4 id="11-jako-komponenteiksi">1.1 jako komponenteiksi</h4>

<p>Luo create-react-app:illa uusi sovellus. Muuta <em>index.js</em> muotoon</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="s1">'react'</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="s1">'react-dom'</span>

<span class="kd">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">kurssi</span> <span class="o">=</span> <span class="s1">'Half Stack -sovelluskehitys'</span>
  <span class="kd">const</span> <span class="nx">osa1</span> <span class="o">=</span> <span class="s1">'Reactin perusteet'</span>
  <span class="kd">const</span> <span class="nx">tehtavia1</span> <span class="o">=</span> <span class="mi">10</span>
  <span class="kd">const</span> <span class="nx">osa2</span> <span class="o">=</span> <span class="s1">'Tiedonvälitys propseilla'</span>
  <span class="kd">const</span> <span class="nx">tehtavia2</span> <span class="o">=</span> <span class="mi">7</span>
  <span class="kd">const</span> <span class="nx">osa3</span> <span class="o">=</span> <span class="s1">'Komponenttien tila'</span>
  <span class="kd">const</span> <span class="nx">tehtavia3</span> <span class="o">=</span> <span class="mi">14</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="si">{</span><span class="nx">kurssi</span><span class="si">}</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="si">{</span><span class="nx">osa1</span><span class="si">}</span> <span class="si">{</span><span class="nx">tehtavia1</span><span class="si">}</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="si">{</span><span class="nx">osa2</span><span class="si">}</span> <span class="si">{</span><span class="nx">tehtavia2</span><span class="si">}</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="si">{</span><span class="nx">osa3</span><span class="si">}</span> <span class="si">{</span><span class="nx">tehtavia3</span><span class="si">}</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>yhteensä <span class="si">{</span><span class="nx">tehtavia1</span> <span class="o">+</span> <span class="nx">tehtavia2</span> <span class="o">+</span> <span class="nx">tehtavia3</span><span class="si">}</span> tehtävää<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">)</span>
<span class="p">}</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
  <span class="p">&lt;</span><span class="nc">App</span> <span class="p">/&gt;,</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'root'</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div>

<p>ja poista ylimääräiset tiedostot.</p>

<p>Koko sovellus on nyt ikävästi yhdessä komponentissa. Refaktoroi sovelluksen koodi siten, että se koostuu kolmesta komponentista <em>Otsikko</em>, <em>Sisalto</em> ja <em>Yhteensa</em>. Kaikki data pidetään edelleen komponentissa <em>App</em>, joka välittää tarpeelliset tiedot kullekin komponentille <em>props:ien</em> avulla. <em>Otsikko</em> huolehtii kurssin nimen renderöimisestä, <em>Sisalto</em> osista ja niiden tehtävämääristä ja <em>Yhteensa</em> tehtävien yhteismäärästä.</p>

<p>Komponentin <em>App</em> runko tulee olemaan suunnilleen seuraavanlainen:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// const-määrittelyt</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nc">Otsikko</span> <span class="na">kurssi=</span><span class="si">{</span><span class="nx">kurssi</span><span class="si">}</span> <span class="p">/&gt;</span>
      <span class="p">&lt;</span><span class="nc">Sisalto</span> <span class="p">...</span> <span class="p">/&gt;</span>
      <span class="p">&lt;</span><span class="nc">Yhteensa</span> <span class="p">...</span> <span class="p">/&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="12-lisää-komponentteja">1.2 lisää komponentteja</h4>

<p>Refaktoroi vielä komponentti <em>Sisalto</em> siten, että se ei itse renderöi yhdenkään osan nimeä eikä sen tehtävälukumäärää vaan ainoastaan kolme <em>Osa</em>-nimistä komponenttia, joista kukin siis renderöi yhden osan nimen ja tehtävämäärän.</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">Sisalto</span> <span class="o">=</span> <span class="p">...</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nc">Osa</span> <span class="p">.../&gt;</span>
      <span class="p">&lt;</span><span class="nc">Osa</span> <span class="p">.../&gt;</span>
      <span class="p">&lt;</span><span class="nc">Osa</span> <span class="p">.../&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Sovelluksemme tiedonvälitys on tällä hetkellä todella alkukantaista, sillä se perustuu yksittäisiin muuttujiin. Tilanne paranee pian.</p>

<h3 id="javascriptin-alkeet">Javascriptin alkeet</h3>

<h4 id="13-tieto-olioissa">1.3 tieto olioissa</h4>

<p>Siirrytään käyttämään sovelluksessamme oliota. Muuta <em>App</em>:in muuttujamäärittelyt seuraavaan muotoon ja muuta sovelluksen kaikkia osia niin, että se taas toimii:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">kurssi</span> <span class="o">=</span> <span class="s1">'Half Stack -sovelluskehitys'</span>
  <span class="kd">const</span> <span class="nx">osa1</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Reactin perusteet'</span><span class="p">,</span>
    <span class="na">tehtavia</span><span class="p">:</span> <span class="mi">10</span>
  <span class="p">}</span>
  <span class="kd">const</span> <span class="nx">osa2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Tiedonvälitys propseilla'</span><span class="p">,</span>
    <span class="na">tehtavia</span><span class="p">:</span> <span class="mi">7</span>
  <span class="p">}</span>
  <span class="kd">const</span> <span class="nx">osa3</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Komponenttien tila'</span><span class="p">,</span>
    <span class="na">tehtavia</span><span class="p">:</span> <span class="mi">14</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
      ...
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="14-oliot-taulukkoon">1.4 oliot taulukkoon</h4>

<p>Ja laitetaan oliot taulukkoon, eli muuta <em>App</em>:in muuttujamäärittelyt seuraavaan muotoon ja muuta sovelluksen kaikki osat vastaavasti:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">kurssi</span> <span class="o">=</span> <span class="s1">'Half Stack -sovelluskehitys'</span>
  <span class="kd">const</span> <span class="nx">osat</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Reactin perusteet'</span><span class="p">,</span>
      <span class="na">tehtavia</span><span class="p">:</span> <span class="mi">10</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Tiedonvälitys propseilla'</span><span class="p">,</span>
      <span class="na">tehtavia</span><span class="p">:</span> <span class="mi">7</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Komponenttien tila'</span><span class="p">,</span>
      <span class="na">tehtavia</span><span class="p">:</span> <span class="mi">14</span>
    <span class="p">}</span>
  <span class="p">]</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
      ...
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>HUOM:</strong> tässä vaiheessa <em>voit olettaa, että taulukossa on aina kolme alkiota</em>, eli taulukkoa ei ole pakko käydä läpi looppaamalla. Palataan taulukossa olevien olioiden perusteella tapahtuvaan komponenttien renderöintiin asiaan tarkemmin kurssin <a href="../osa2">seuraavassa osassa</a>.</p>

<p>Älä kuitenkaan välitä eri olioita komponenttien välillä (esim. komponentista <em>App</em> komponenttiin <em>Yhteensa</em>) erillisinä propsina, vaan suoraan taulukkona:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// const-määrittelyt</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nc">Otsikko</span> <span class="na">kurssi=</span><span class="si">{</span><span class="nx">kurssi</span><span class="si">}</span> <span class="p">/&gt;</span>
      <span class="p">&lt;</span><span class="nc">Sisalto</span> <span class="na">osat=</span><span class="si">{</span><span class="nx">osat</span><span class="si">}</span> <span class="p">/&gt;</span>
      <span class="p">&lt;</span><span class="nc">Yhteensa</span> <span class="na">osat=</span><span class="si">{</span><span class="nx">osat</span><span class="si">}</span> <span class="p">/&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="15">1.5</h4>

<p>Viedään muutos vielä yhtä askelta pidemmälle, eli tehdään kurssista ja sen osista yksi Javascript-olio. Korjaa kaikki mikä menee rikki.</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">kurssi</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Half Stack -sovelluskehitys'</span><span class="p">,</span>
    <span class="na">osat</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Reactin perusteet'</span><span class="p">,</span>
        <span class="na">tehtavia</span><span class="p">:</span> <span class="mi">10</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Tiedonvälitys propseilla'</span><span class="p">,</span>
        <span class="na">tehtavia</span><span class="p">:</span> <span class="mi">7</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Komponenttien tila'</span><span class="p">,</span>
        <span class="na">tehtavia</span><span class="p">:</span> <span class="mi">14</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
      ...
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="lisää-reactia">lisää reactia</h3>

<h4 id="16-unicafe-osa1">1.6 unicafe osa1</h4>

<p>Monien firmojen tapaan nykyään myös <a href="https://www.unicafe.fi/#/9/4">Unicafe</a> kerää asiakaspalautetta. Tee Unicafelle verkossa toimiva palautesovellus. Vastausvaihtoehtoja olkoon vain kolme: <em>hyvä</em>, <em>neutraali</em> ja <em>huono</em>.</p>

<p>Sovelluksen tulee näyttää jokaisen palautteen lukumäärä. Sovellus voi näyttää esim. seuraavalta:</p>

<p><img src="http://localhost:4000/images/teht/4c.png" alt="" /></p>

<p>Huomaa, että sovelluksen tarvitsee toimia vain yhden selaimen käyttökerran ajan, esim. kun selain refreshataan, tilastot saavat hävitä.</p>

<h4 id="17-unicafe-osa2">1.7 unicafe osa2</h4>

<p>Laajenna sovellusta siten, että se näyttää palautteista statistiikkaa, keskiarvon (hyvän arvo 1, neutraalin 0, huonon -1) ja sen kuinka monta prosenttia palautteista on ollut positiivisia:</p>

<p><img src="http://localhost:4000/images/teht/4d.png" alt="" /></p>

<h4 id="18-unicafe-osa3">1.8 unicafe osa3</h4>

<p>Refaktoroi sovelluksesi siten, että se koostuu monista komponenteista. Pidä tila kuitenkin sovelluksen <em>juurikomponentissa</em>.</p>

<p>Tee sovellukseen ainakin seuraavat komponentit:</p>
<ul>
  <li><em>Button</em> vastaa yksittäistä palautteenantonappia</li>
  <li><em>Statistics</em> huolehtii tilastojen näyttämisestä</li>
  <li><em>Statistic</em> huolehtii yksittäisen tilastorivin, esim. keskiarvon näyttämisestä</li>
</ul>

<h4 id="19-unicafe-osa4">1.9* unicafe osa4</h4>

<p>Muuta sovellusta siten, että numeeriset tilastot näytetään ainoastaan jos palautteita on jo annettu:</p>

<p><img src="http://localhost:4000/images/teht/5.png" alt="" /></p>

<h4 id="110-unicafe-osa5">1.10* unicafe osa5</h4>

<p>Jos olet määritellyt jokaiselle napille oman tapahtumankäsittelijän, refaktoroi sovellustasi siten, että kaikki napit käyttävät samaa tapahtumankäsittelijäfunktiota samaan tapaan kuin materiaalin luvussa <a href="/osa1/#funktio-joka-palauttaa-funktion">funktio joka palauttaa funktion</a></p>

<p>Pari vihjettä. Ensinnäkin kannattaa muistaa, että olion kenttiin voi viitata pistenotaation lisäksi hakasulkeilla, eli</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">olio</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">a</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="na">b</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">}</span>

<span class="nx">olio</span><span class="p">[</span><span class="s1">'c'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">olio</span><span class="p">.</span><span class="nx">a</span><span class="p">)</span>     <span class="c1">// tulostuu 1</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">olio</span><span class="p">[</span><span class="s1">'b'</span><span class="p">])</span>  <span class="c1">// tulostuu 2</span>

<span class="kd">const</span> <span class="nx">apu</span> <span class="o">=</span> <span class="s1">'c'</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">olio</span><span class="p">[</span><span class="nx">apu</span><span class="p">])</span>  <span class="c1">// tulostuu 3</span>
</code></pre></div></div>

<p>Myös ns. <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Object_initializer">Computed property names</a> voi olla tässä tehtävässä hyödyksi.</p>

<h4 id="111-unicafe-osa6">1.11 unicafe osa6</h4>

<p>Toteuta tilastojen näyttäminen HTML:n <a href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Tables/Basics">taulukkona</a> siten, että saat sovelluksesi näyttämään suunnilleen seuraavanlaiselta</p>

<p><img src="http://localhost:4000/images/teht/6a.png" alt="" /></p>

<p>Muista pitää konsoli koko ajan auki. Jos saat konsoliin seuraavan warningin</p>

<p><img src="http://localhost:4000/assets/teht/7.png" alt="" /></p>

<p>tee tarvittavat toimenpiteet jotta saat warningin katoamaan. Googlaa tarvittaessa virheilmoituksella.</p>

<p><strong>Huolehdi nyt ja jatkossa, että konsolissa ei näy mitään warningeja!</strong></p>

<h4 id="112-anekdootit-osa1">1.12* anekdootit osa1</h4>

<p>Ohjelmistotuotannossa tunnetaan lukematon määrä <a href="http://www.comp.nus.edu.sg/~damithch/pages/SE-quotes.htm">anekdootteja</a> eli pieniä “onelinereita”, jotka kiteyttävät alan ikuisia totuuksia.</p>

<p>Laajenna seuraavaa sovellusta siten, että siihen tulee nappi, jota painamalla sovellus näyttää <em>satunnaisen</em> ohjelmistotuotantoon liittyvän anekdootin:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="s1">'react'</span>
<span class="k">import</span> <span class="nx">ReactDOM</span> <span class="k">from</span> <span class="s1">'react-dom'</span>

<span class="kd">class</span> <span class="nx">App</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">selected</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">anecdotes</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">selected</span><span class="p">]</span><span class="si">}</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">anecdotes</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s1">'If it hurts, do it more often'</span><span class="p">,</span>
  <span class="s1">'Adding manpower to a late software project makes it later!'</span><span class="p">,</span>
  <span class="s1">'The first 90 percent of the code accounts for the first 90 percent of the development time...The remaining 10 percent of the code accounts for the other 90 percent of the development time.'</span><span class="p">,</span>
  <span class="s1">'Any fool can write code that a computer can understand. Good programmers write code that humans can understand.'</span><span class="p">,</span>
  <span class="s1">'Premature optimization is the root of all evil.'</span><span class="p">,</span>
  <span class="s1">'Debugging is twice as hard as writing the code in the first place. Therefore, if you write the code as cleverly as possible, you are, by definition, not smart enough to debug it.'</span>
<span class="p">]</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>
  <span class="p">&lt;</span><span class="nc">App</span> <span class="na">anecdotes=</span><span class="si">{</span><span class="nx">anecdotes</span><span class="si">}</span> <span class="p">/&gt;,</span>
  <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'root'</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div>

<p>Google kertoo, miten voit generoida Javascriptilla sopivia satunnaisia lukuja. Muista, että voit testata esim. satunnaislukujen generointia konsolissa.</p>

<p>Sovellus voi näyttää esim. seuraavalta:</p>

<p><img src="http://localhost:4000/images/teht/2.png" alt="" /></p>

<h4 id="113-anekdootit-osa2">1.13* anekdootit osa2</h4>

<p>Laajenna sovellusta siten, että näytettävää anekdoottia on mahdollista äänestää:</p>

<p><img src="http://localhost:4000/images/teht/3.png" alt="" /></p>

<p><strong>Huom:</strong> jos päätät tallettaa kunkin anekdootin äänet komponentin tilassa olevan olion kenttiin tai taulukkoon, saatat tarvita päivittäessäsi tilaa oikeaoppisesti olion tai taulukon <em>kopioimista</em>.</p>

<p>Olio voidaan kopioida esim. seuraavasti:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">pisteet</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>

<span class="kd">const</span> <span class="nx">kopio</span> <span class="o">=</span> <span class="p">{...</span><span class="nx">pisteet</span><span class="p">}</span>
<span class="nx">kopio</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>   <span class="c1">// kasvatetaan olion kentän 2 arvoa yhdellä</span>
</code></pre></div></div>

<p>ja taulukko esim. seuraavasti:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">pisteet</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="kd">const</span> <span class="nx">kopio</span> <span class="o">=</span> <span class="p">[...</span><span class="nx">pisteet</span><span class="p">]</span>
<span class="nx">kopio</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>   <span class="c1">// kasvatetaan taulukon paikan 2 arvoa yhdellä</span>
</code></pre></div></div>

<h4 id="114-anekdootit-osa3">1.14* anekdootit osa3</h4>

<p>Ja sitten vielä lopullinen versio, joka näyttää eniten ääniä saaneen anekdootin:</p>

<p><img src="http://localhost:4000/images/teht/3b.png" alt="" /></p>

<p>Jos suurimman äänimäärän saaneita anekdootteja on useita, riittää että niistä näytetään yksi.</p>

<p>Tämä saattaa olla jo hieman haastavampi. Taulukolta löytyy monia hyviä metodeja, katso lisää <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">Mozillan dokumentaatiosta</a>.</p>

<p>Youtubessa on kohtuullisen hyvä <a href="https://www.youtube.com/watch?v=BMUiFMZr7vk&amp;list=PL0zVEGEvSaeEd9hlmCXrk5yUyqUag-n84">johdatus funktionaaliseen javascript-ohjelmointiin</a>. Kolmen ensimmäisen osan katsominen riittää hyvin tässä vaiheessa.</p>

<h3 id="tehtävien-palautus-1">Tehtävien palautus</h3>

<p>Palauta tehtävät <a href="https://studies.cs.helsinki.fi/fs-stats/">palautussovellukseen</a>.</p>

<h2 id="osa-2">Osa 2</h2>

<p>deadline 5.2. klo 23:59</p>

<p>Osassa on 19 tehtävää, joista “pakollisia” on 13. On suositeltavaa että etenet seuraavaan osaan vasta kun olet tehnyt kaikki pakolliset tehtävät. Palautuksen tekemisen jälkeen et voi enää palauttaa osan tehtäviä.</p>

<p>Osa sisältää kolme tehtäväsarjaa, joissa yksittäistä ohjelmaa laajennetaan pala palalta. Ohjelmien lopullisen version palauttaminen riittää, voit toki halutessasi tehdä commitin jokaisen tehtävän jälkeisestä tilanteesta, mutta se ei ole välttämätöntä.</p>

<div class="important">

<p>Ennen kun teet tehtäviä, on enemmän kuin suositeltavaa, että käyt huolellisesti läpi <a href="https://fullstack-hy.github.io/osa2/">osan 2 materiaalin</a>. Tehtävien tekeminen ilman materiaalin lukemista tapahtuu täysin omalla vastuulla.</p>

</div>
<h3 id="kokoelmien-renderöinti">Kokoelmien renderöinti</h3>

<h4 id="21-kurssien-sisältö">2.1 kurssien sisältö</h4>

<p>Viimeistellään nyt tehtävien 1.1-1.5 kurssin sisältöjä renderöivän ohjelman koodi. Voit ottaa tarvittaessa pohjaksi mallivastauksen koodin.</p>

<p>Muutetaan komponentti <em>App</em> seuraavasti:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">kurssi</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Half Stack -sovelluskehitys'</span><span class="p">,</span>
    <span class="na">osat</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Reactin perusteet'</span><span class="p">,</span>
        <span class="na">tehtavia</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
        <span class="na">id</span><span class="p">:</span> <span class="mi">1</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Tiedonvälitys propseilla'</span><span class="p">,</span>
        <span class="na">tehtavia</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
        <span class="na">id</span><span class="p">:</span> <span class="mi">2</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Komponenttien tila'</span><span class="p">,</span>
        <span class="na">tehtavia</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
        <span class="na">id</span><span class="p">:</span> <span class="mi">3</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nc">Kurssi</span> <span class="na">kurssi=</span><span class="si">{</span><span class="nx">kurssi</span><span class="si">}</span> <span class="p">/&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Määrittele sovellukseen yksittäisen kurssin muotoilusta huolehtiva komponentti <em>Kurssi</em>.</p>

<p>Sovelluksen komponenttirakenne voi olla esim. seuraava</p>

<pre>
App
  Kurssi
    Otsikko
    Sisalto
      Osa
      Osa
      ...
</pre>

<p>ja renderöityvä sivu voi näyttää esim. seuraavalta:</p>

<p><img src="http://localhost:4000/images/teht/8.png" alt="" /></p>

<p>Tässä vaiheessa siis tehtävien yhteenlaskettua lukumäärää ei vielä tarvita.</p>

<p>Sovelluksen täytyy luonnollisesti toimia <em>riippumatta kurssissa olevien osien määrästä</em>, eli varmista että sovellus toimii jos lisäät tai poistat kurssin osia.</p>

<p>Varmista, että konsolissa ei näy mitään virheilmoituksia!</p>

<h4 id="22-tehtävien-määrä">2.2 tehtävien määrä</h4>

<p>Ilmoita myös kurssin yhteenlaskettu tehtävien lukumäärä</p>

<p><img src="http://localhost:4000/images/teht/9.png" alt="" /></p>

<h4 id="23-reduce">2.3* reduce</h4>

<p>Jos et jo niin tehnyt, laske koodissasi tehtävien määrä taulukon metodilla <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce">reduce</a></p>

<h4 id="24-monta-kurssia">2.4 monta kurssia</h4>

<p>Laajennetaan sovellusta siten, että kursseja voi olla <em>mielivaltainen määrä</em>:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">App</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">kurssit</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Half Stack -sovelluskehitys'</span><span class="p">,</span>
      <span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="na">osat</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Reactin perusteet'</span><span class="p">,</span>
          <span class="na">tehtavia</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
          <span class="na">id</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Tiedonvälitys propseilla'</span><span class="p">,</span>
          <span class="na">tehtavia</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
          <span class="na">id</span><span class="p">:</span> <span class="mi">2</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Komponenttien tila'</span><span class="p">,</span>
          <span class="na">tehtavia</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
          <span class="na">id</span><span class="p">:</span> <span class="mi">3</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Node.js'</span><span class="p">,</span>
      <span class="na">id</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="na">osat</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Routing'</span><span class="p">,</span>
          <span class="na">tehtavia</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
          <span class="na">id</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="na">nimi</span><span class="p">:</span> <span class="s1">'Middlewaret'</span><span class="p">,</span>
          <span class="na">tehtavia</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
          <span class="na">id</span><span class="p">:</span> <span class="mi">2</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
      // ...
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Sovelluksen ulkoasu voi olla esim seuraava:</p>

<p><img src="http://localhost:4000/images/teht/10.png" alt="" /></p>

<h4 id="25-erillinen-moduuli">2.5 erillinen moduuli</h4>

<p>Määrittele komponentti <em>Kurssi</em> omana moduulinaan, jonka komponentti <em>App</em> importtaa. Voit sisällyttää kaikki kurssin alikomponentit samaan moduuliin.</p>

<h3 id="lomakkeet">Lomakkeet</h3>

<h4 id="26-puhelinluettelo-osa-1">2.6 puhelinluettelo osa 1</h4>

<p>Toteutetaan yksinkertainen puhelinluettelo. <strong>Aluksi luetteloon lisätään vaan nimiä.</strong></p>

<p>Voit ottaa sovelluksesi pohjaksi seuraavan:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="s1">'react'</span><span class="p">;</span>

<span class="kd">class</span> <span class="nx">App</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">persons</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="s1">'Arto Hellas'</span> <span class="p">}</span>
      <span class="p">],</span>
      <span class="na">newName</span><span class="p">:</span> <span class="s1">''</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Puhelinluettelo<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">form</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
            nimi: <span class="p">&lt;</span><span class="nt">input</span> <span class="p">/&gt;</span>
          <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type=</span><span class="s2">"submit"</span><span class="p">&gt;</span>lisää<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
          <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Numerot<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
        ...
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">App</span>
</code></pre></div></div>

<p>Tilassa oleva kenttä <em>newName</em> on tarkoitettu lomakkeen kentän kontrollointiin.</p>

<p>Joskus tilan muuttujia ja tarvittaessa muitakin voi olla hyödyllistä renderöidä debugatessa komponenttiin, eli voi tilapäisesti lisätä komponentin metodin <em>render</em> palauttamaan koodiin esim. seuraavan:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div&gt;</span>
  debug: {this.state.newName}
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<p>Muista myös osan 1 luku <a href="#React-sovellusten-debuggaus">React-sovellusten debuggaus</a>, erityisesti <a href="https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi">react developer tools</a> on välillä todella kätevä tilan komponentin tilan muutosten seuraamisessa.</p>

<p>Sovellus voi näyttää tässä vaiheessa seuraavalta</p>

<p><img src="http://localhost:4000/images/teht/11.png" alt="" /></p>

<p>Huomaa, React developer toolsin käyttö!</p>

<p><strong>Huom:</strong></p>
<ul>
  <li>voit käyttää kentän <em>key</em> arvona henkilön nimeä</li>
  <li>muista estää lomakkeen lähetyksen oletusarvoinen toiminta!</li>
</ul>

<h4 id="27-puhelinluettelo-osa-2">2.7 puhelinluettelo osa 2</h4>

<p>Jos lisättävä nimi on jo sovelluksen tiedossa, estä lisäys. Taulukolla on lukuisia sopivia <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">metodeja</a> tehtävän tekemiseen.</p>

<p>Voit antaa halutessasi virheilmoituksen esim. komennolla <em>alert()</em>. Se ei kuitenkaan ole tarpeen.</p>

<h4 id="28-puhelinluettelo-osa-3">2.8 puhelinluettelo osa 3</h4>

<p>Lisää sovellukseen mahdollisuus antaa henkilöille puhelinnumero. Tarvitset siis lomakkeeseen myös toisen <em>input</em>-elementin (ja sille oman muutoksenkäsittelijän):</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;form&gt;</span>
  <span class="nt">&lt;div&gt;</span>
    nimi: <span class="nt">&lt;input</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div&gt;</span>
    numero: <span class="nt">&lt;input</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>lisää<span class="nt">&lt;/button&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</code></pre></div></div>

<p>Sovellus voi näyttää tässä vaiheessa seuraavalta. Kuvassa myös <a href="https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi">react developer tools</a>:in tarjoama näkymä komponentin <em>App</em> tilaan:</p>

<p><img src="http://localhost:4000/assets/teht/12.png" alt="" /></p>

<h4 id="29-puhelinluettelo-osa-4">2.9* puhelinluettelo osa 4</h4>

<p>Tee lomakkeeseen hakukenttä, jonka avulla näytettävien nimien listaa voidaan rajata:</p>

<p><img src="http://localhost:4000/assets/teht/12c.png" alt="" /></p>

<p>Rajausehdon syöttämisen voi hoitaa omana lomakkeeseen kuulumattomana <em>input</em>-elementtinä. Kuvassa rajausehdosta on tehty <em>caseinsensitiivinen</em> eli ehto <em>arto</em> löytää isolla kirjaimella kirjoitetun Arton.</p>

<p><strong>Huom:</strong> Kun toteutat jotain uutta toiminnallisuutta, on usein hyötyä ‘kovakoodata’ sovellukseen jotain sisältöä, esim.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">persons</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="s1">'Arto Hellas'</span><span class="p">,</span> <span class="na">number</span><span class="p">:</span> <span class="s1">'040-123456'</span> <span class="p">},</span>
      <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="s1">'Martti Tienari'</span><span class="p">,</span> <span class="na">number</span><span class="p">:</span> <span class="s1">'040-123456'</span> <span class="p">},</span>
      <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="s1">'Arto Järvinen'</span><span class="p">,</span> <span class="na">number</span><span class="p">:</span> <span class="s1">'040-123456'</span> <span class="p">},</span>
      <span class="p">{</span> <span class="na">name</span><span class="p">:</span> <span class="s1">'Lea Kutvonen'</span><span class="p">,</span> <span class="na">number</span><span class="p">:</span> <span class="s1">'040-123456'</span> <span class="p">}</span>
    <span class="p">],</span>
    <span class="na">newName</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="na">newNumber</span><span class="p">:</span> <span class="s1">''</span><span class="p">,</span>
    <span class="na">filter</span><span class="p">:</span> <span class="s1">''</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Näin vältytään turhalta manuaaliselta työltä, missä testaaminen edellyttäisi myös testiaineiston syöttämistä käsin soveluksen lomakkeen kautta.</p>

<p>Kurssin seuraavasta osasta alkaen alamme määrittelemään sovelluksemme <em>testejä</em> jotka tietyissä tapauksissa hoitavat kovakoodatun apusyötteen roolia.</p>

<h4 id="210-puhelinluettelo-osa-5">2.10 puhelinluettelo osa 5</h4>

<p>Jos koko sovelluksesi on tehty yhteen komponenttiin, refaktoroi sitä eriyttämällä sopivia komponentteja. Pidä kuitenkin edelleen kaikki tila juurikomponentissa.</p>

<p>Riittää että erotat sovelluksesta kaksi kompoenttia. Hyviä kandidaatteja ovat esim. filtteröintilomake, yksittäisten henkilön tietojen esittäminen ja uuden henkilön lisäävä lomake.</p>

<h3 id="datan-hakeminen-palvelimelta">Datan hakeminen palvelimelta</h3>

<h4 id="211-puhelinluettelo-osa-6">2.11 puhelinluettelo osa 6</h4>

<p>Talleta sovelluksen alkutila projektin juureen sijoitettavaan tiedostoon <em>db.json</em></p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"persons"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Arto Hellas"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"040-123456"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Martti Tienari"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"040-123456"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Arto Järvinen"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"040-123456"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Lea Kutvonen"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"040-123456"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Käynnistä json-server porttiin 3001 ja varmista selaimella osoitteesta <a href="http://localhost:3001/persons">http://localhost:3001/persons</a>, että palvelin palauttaa henkilölistan.</p>

<p>Jos saat virheilmoituksen</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>events.js:182
      throw er<span class="p">;</span> // Unhandled <span class="s1">'error'</span> event
      ^

Error: listen EADDRINUSE 0.0.0.0:3001
    at Object._errnoException <span class="o">(</span>util.js:1019:11<span class="o">)</span>
    at _exceptionWithHostPort <span class="o">(</span>util.js:1041:20<span class="o">)</span>
</code></pre></div></div>

<p>on portti 3001 jo jonkin muun sovelluksen, esim. jo käynnissä olevan json-serverin käytössä. Sulje toinen sovellus tai jos se ei onnistu, vaihda porttia.</p>

<p>Muuta sovellusta siten, että datan alkutila haetaan <em>axios</em>-kirjaston avulla palvelimelta. Hoida datan hakeminen <a href="/osa2#komponenttien-lifecycle-metodit">lifecyclemetodissa</a> <em>componentWillMount</em>.</p>

<h4 id="212-maiden-tiedot">2.12* maiden tiedot</h4>

<p>Rajapinta <a href="https://restcountries.eu">https://restcountries.eu</a> tarjoaa paljon eri maihin liittyvää tietoa koneluettavassa muodossa REST-apina.</p>

<p>Tee sovellus, jonka avulla voit tarkastella eri maiden tietoja. Sovelluksen kannattaa hakea tiedot endpointista <a href="https://restcountries.eu/#api-endpoints-all">all</a>.</p>

<p>Sovelluksen käyttöliittymä on yksinkertainen. Näytettävä maa haetaan kirjoittamalla hakuehto etsintäkenttään.</p>

<p>Jos ehdon täyttäviä maita on liikaa (yli 10), kehoitetaan tarkentamaan hakuehtoa</p>

<p><img src="http://localhost:4000/assets/teht/13.png" alt="" /></p>

<p>Jos maita on alle kymmenen, mutta yli 1 näytetään hakuehdon täyttävät maat</p>

<p><img src="http://localhost:4000/assets/teht/14.png" alt="" /></p>

<p>Kun ehdon täyttäviä maita on enää yksi, näytetään maan lippu sekä perustiedot:</p>

<p><img src="http://localhost:4000/assets/teht/15.png" alt="" /></p>

<p><strong>Huom:</strong> riittää että sovelluksesi toimii suurimmalle osalle maista. Jotkut maat kuten <em>Sudan</em> voivat tuottaa ongelmia, sillä maan nimi on toisen maan <em>South Sudan</em> osa. Näistä corner caseista ei tarvitse välittää.</p>

<h4 id="213-maiden-tiedot-klikkaamalla">2.13* maiden tiedot klikkaamalla</h4>

<p><strong>Älä juutu tähän tehtävään!</strong></p>

<p>Paranna edellisen tehtävän maasovellusta siten, että kun sivulla näkyy useiden maiden nimiä, riittää maan nimen klikkaaminen tarkentamaan haun siten, että klikatun maan tarkemmat tiedot saadaan näkyviin.</p>

<p>Huomaa, että saat “nimestä” klikattavan kiinnittämällä nimen sisältävään elementtiin, esim. diviin klikkaustenkuuntelijan:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;div onClick={...}&gt;
  {country.name}
&lt;/div&gt;
</code></pre></div></div>

<h3 id="palvelimella-olevan-datan-päivittäminen">palvelimella olevan datan päivittäminen</h3>

<h4 id="214-puhelinluettelo-osa-7">2.14 puhelinluettelo osa 7</h4>

<p>Palataan jälleen puhelinluettelon pariin.</p>

<p>Tällä hetkellä luetteloon lisättäviä uusia numeroita ei synkronoida palvelimelle. Korjaa tilanne.</p>

<h4 id="215-puhelinluettelo-osa-8">2.15 puhelinluettelo osa 8</h4>

<p>Siirrä palvelimen kanssa kommunikoinnista vastaava toiminnallisuus omaan moduuliin osan 2 <a href="/osa2/#palvelimen-kanssa-tapahtuvan-kommunikoinnin-erist%C3%A4minen-omaan-moduuliin">esimerkin</a> tapaan.</p>

<h4 id="216-puhelinluettelo-osa-9">2.16 puhelinluettelo osa 9</h4>

<p>Tee ohjelmaan mahdollisuus yhteystietojen poistamiseen. Poistaminen voi tapahtua esim. nimen yhteyteen liitetyllä napilla. Poiston suorittaminen voidaan varmistaa käyttäjältä <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/confirm">window.confirm</a>-metodilla:</p>

<p><img src="http://localhost:4000/assets/teht/16.png" alt="" /></p>

<p>Palvelimelta tiettyä henkilöä vastaava resurssi tuhotaan tekemällä HTTP DELETE -pyyntö resurssia vastaavaan <em>URL</em>:iin, eli jos poistaisimme esim. käyttäjän, jonka <em>id</em> on 2, tulisi tapauksessamme tehdä HTTP DELETE osoitteeseen <em>localhost:3001:persons/2</em>. Pyynnön mukana ei lähetetä mitään dataa.</p>

<p><a href="https://github.com/axios/axios">Axios</a>-kirjaston avulla HTTP DELETE -pyyntö tehdään samaan tapaan kuin muutkin pyynnöt.</p>

<h4 id="217-puhelinluettelo-osa-10">2.17* puhelinluettelo osa 10</h4>

<p>Muuta toiminnallisuutta siten, että jos jo olemassaolevalle henkilölle lisätään numero, korvaa lisätty numero aiemman numeron.</p>

<p>Jos henkilön tiedot löytyvät jo luettelosta, voi ohjelma kysyä käyttäjältä varmistuksen korvataanko numero</p>

<p><img src="http://localhost:4000/images/teht/16a.png" alt="" /></p>

<h3 id="tyylit">tyylit</h3>

<h4 id="218-puhelinluettelo-osa-11">2.18 puhelinluettelo osa 11</h4>

<p>Toteuta osan 2 esimerkin <a href="/osa2/#parempi-virheilmoitus">parempi virheilmoitus</a> tyyliin ruudulla muutaman sekunnin näkyvä ilmoitus, joka kertoo onnistuneista operaatioista (henkilön lisäys ja poisto, sekä numeron muutos):</p>

<p><img src="http://localhost:4000/assets/teht/17.png" alt="" /></p>

<h4 id="219-puhelinluettelo-osa-12">2.19* puhelinluettelo osa 12</h4>

<p>Jos poistat jonkun henkilön toisesta selaimesta hieman ennen kun yrität <em>muuttaa henkilön numeroa</em> toisesta selaimesta, tapahtuu virhetilanne:</p>

<p><img src="http://localhost:4000/assets/teht/18.png" alt="" /></p>

<p>Korjaa ongelma osan 2 esimerkin <a href="/osa2/#promise-ja-virheet">promise ja virheet</a> tapaan. Loogisin korjaus lienee henkilön lisääminen uudelleen palvelimelle. Toinen vaihtoehto on ilmottaa käyttäjälle, että muutettavaksi yritettävän henkilön tiedot on jo poistettu.</p>

<h3 id="tehtävien-palautus-2">Tehtävien palautus</h3>

<p>Palauta tehtävät <a href="https://studies.cs.helsinki.fi/fs-stats/">palautussovellukseen</a>.</p>

<h2 id="osa-3">Osa 3</h2>

<p>Deadline 12.2. klo 23:59</p>

<p>Osassa on 22 tehtävää, joista “pakollisia” on 15. On suositeltavaa että etenet seuraavaan osaan vasta kun olet tehnyt kaikki pakolliset tehtävät. Palautuksen tekemisen jälkeen et voi enää palauttaa osan tehtäviä.</p>

<p>Tämän osan tehtävissä teemme backendin edellisen osan puhelinluettelosovellukseen. Lopullisen version palauttaminen riittää, voit toki halutessasi tehdä commitin jokaisen tehtävän jälkeisestä tilanteesta, mutta se ei ole välttämätöntä.</p>

<p><strong>HUOM tämän osan tehtäväsarja kannattaa tehdä omaan git-repositorioon, suoraan repositorion juureen! Jos et tee näin, joudut ongelmiin tehtävässä 3.10</strong>.</p>

<p><strong>HUOM2</strong> Windows-käyttäjien ei kannata tehdä tehtävää sellaiseen hakemistoon, jonka nimessä on välilyönti, muuten osassa 4 on luvassa ongelmia. Myöskään missään tämän tehtävän hakemiston yläpuolella olevassa hakemistossa ei saa esiintyä välilyöntiä.</p>

<div class="important">

<p>Ennen kun teet tehtäviä, on enemmän kuin suositeltavaa, että käyt huolellisesti läpi <a href="https://fullstack-hy.github.io/osa3/">osan 3 materiaalin</a>. Tehtävien tekeminen ilman materiaalin lukemista tapahtuu täysin omalla vastuulla.</p>

</div>

<h3 id="expressin-alkeet">Expressin alkeet</h3>

<h4 id="31-puhelinluettelon-backend-osa-1">3.1 puhelinluettelon backend osa 1</h4>

<p>Vielä uusi <strong>HUOMAUTUS:</strong> tämän osan tehtäväsarja kannattaa tehdä omaan git-repositorioon, suoraan repositorion juureen! Jos et tee näin, joudut ongelmiin tehtävässä 3.10</p>

<p><strong>Vahva suositus:</strong> kun teet backendin koodia, pidä koko ajan silmällä mitä palvelimen koodia suorittavassa konsolissa tapahtuu.</p>

<p>Tee Node-sovellus, joka tarjoaa osoitteessa <a href="http://localhost:3001/api/persons">http://localhost:3001/api/persons</a> kovakoodatun taulukon puhelinnumerotietoja:</p>

<p><img src="http://localhost:4000/assets/teht/19.png" alt="" /></p>

<div class="important">

Koska nyt ei ole kyse fronendista ja Reactista, sovellusta <strong>ei luoda</strong> create-react-app:illa vaan komennolla <em>npm init</em> osan 3 luvun <a href="../osa3#node.js">Node.js</a> tapaan.

</div>

<p>Huomaa, että Noden routejen määrittelyssä merkkijonon <em>api/persons</em> vinoviiva käyttäytyy kuten mikä tahansa muu merkki.</p>

<p>Sovellus pitää pystyä käynnistämään komennolla <em>npm start</em>.</p>

<p>Komennolla <em>npm run watch</em> käynnistettäessa sovelluksen tulee käynnistyä uudelleen kun koodiin tehdään muutoksia.</p>

<h4 id="32-puhelinluettelon-backend-osa-2">3.2 puhelinluettelon backend osa 2</h4>

<p>Tee sovelluksen osoitteeseen <a href="http://localhost:3001/info">http://localhost:3001/info</a> suunnilleen seuraavanlainen sivu</p>

<p><img src="http://localhost:4000/assets/teht/20.png" alt="" /></p>

<p>eli sivu kertoo pyynnön tekohetken sekä sen kuinka monta puhelinluettelotietoa sovelluksen muistissa olevassa taulukossa on.</p>

<h4 id="33-puhelinluettelon-backend-osa-3">3.3 puhelinluettelon backend osa 3</h4>

<p>Toteuta toiminnallisuus yksittäisen puhelinnumerotiedon näyttämiseen. Esim. id:n 5 omaavan numerotiedon url on <a href="http://localhost:3001/api/persons/5">http://localhost:3001/api/persons/5</a></p>

<p>Jos id:tä vastaavaa puhelinnumerotietoa ei ole, tulee palvelimen vastata asianmukaisella statuskoodilla.</p>

<h4 id="34-puhelinluettelon-backend-osa-4">3.4 puhelinluettelon backend osa 4</h4>

<p>Toteuta toiminnallisuus, jonka avulla puhelinnumerotieto on mahdollista poistaa numerotiedon yksilöivään URL:iin tehtävällä HTTP DELETE -pyynnöllä.</p>

<p>Testaa toiminnallisuus Postmanilla tai Visual Studio Coden REST clientillä</p>

<h4 id="35-puhelinluettelon-backend-osa-5">3.5 puhelinluettelon backend osa 5</h4>

<p>Laajenna backendia siten, että uusia puhelintietoja on mahdollista lisätä osoitteeseen <a href="http://localhost:3001/api/persons">http://localhost:3001/api/persons</a> tapahtuvalla HTTP POST -pyynnöllä.</p>

<p>Generoi uuden puhelintiedon tunniste funktiolla <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/random">Math.random</a>. Käytä riittävän isoa arvoväliä jotta arvottu id on riittävän suurella todennäköisyydellä sellainen, joka ei ole jo käytössä.</p>

<h4 id="36-puhelinluettelon-backend-osa-6">3.6* puhelinluettelon backend osa 6</h4>

<p>Tee uuden numeron lisäykseen virheiden käsittely. Pyyntö ei saa onnistua, jos</p>
<ul>
  <li>nimi tai numero puuttuu</li>
  <li>lisättävä nimi on jo luettelossa</li>
</ul>

<p>Vastaa asiaankuuluvalla statuskoodilla, liitä vastaukseen mukaan myös tieto, joka kertoo virheen syyn, esim:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span> <span class="nl">error</span><span class="p">:</span> <span class="s1">'name must be unique'</span> <span class="p">}</span>
</code></pre></div></div>

<h3 id="lisää-middlewareja">lisää middlewareja</h3>

<h4 id="37-puhelinluettelon-backend-osa-7">3.7 puhelinluettelon backend osa 7</h4>

<p>Lisää sovellukseesi loggausta tekevä middleware <a href="https://github.com/expressjs/morgan">morgan</a>. Konfiguroi se logaamaan konsoliin <em>tiny</em>-konfiguraation mukaisesti.</p>

<p>Morganin ohjeet eivät ole ehkä kaikkein selvimmät ja joudut kenties miettimään hiukan. Toisaalta juuri koskaan dokumentaatio ei ole aivan itsestäänselvää, joten kryptisempiäkin asioita on hyvä oppia tulkitsemaan.</p>

<p>Morgan asennetaan kuten muutkin kirjastot, eli komennolla <em>npm install</em> ja sen käyttöönotto tapahtuu kaikkien middlewarejen tapaan komennolla <em>app.use</em></p>

<h4 id="38-puhelinluettelon-backend-osa-8">3.8* puhelinluettelon backend osa 8</h4>

<p>Konfiguroi morgania siten, että se näyttää myös HTTP-pyyntöjen mukana tulevan datan:</p>

<p><img src="http://localhost:4000/assets/teht/21.png" alt="" /></p>

<p>Tämä tehtävä on kohtuullisen haastava vaikka koodia ei tarvitakkaan paljoa.</p>

<p>Pari vihjettä:</p>
<ul>
  <li><a href="https://github.com/expressjs/morgan#creating-new-tokens">creating new tokens</a></li>
  <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify">JSON.stringify</a></li>
</ul>

<h3 id="yhteys-frontendiin-ja-vienti-tuotantoon">yhteys frontendiin ja vienti tuotantoon</h3>

<h4 id="39-puhelinluettelon-backend-osa-9">3.9 puhelinluettelon backend osa 9</h4>

<p>Laita backend toimimaan edellisessä osassa tehdyn puhelinluettelon frontendin kanssa muilta osin, paitsi mahdollisen puhelinnumeron muutoksen osalta jonka vastaava toiminnallisuus toteutetaan backendiin vasta tehtävässä 3.17.</p>

<p>Joudut todennäköisesti tekemään frontendiin erinäisiä pieniä muutoksia ainakin backendin oletettujen urlien osalta. Muista pitää selaimen konsoli koko ajan auki. Jos jotkut HTTP-pyynnöt epäonnistuvat, kannattaa katsoa <em>Network</em>-välilehdeltä mitä tapahtuu. Pidä myös silmällä mitä palvelimen konsolissa tapahtuu. Jos et tehnyt edellistä tehtävää, kannattaa POST-pyyntöä käsittelevässä tapahtumankäsittelijässä tulostaa konsoliin mukana tuleva data eli <em>request.body</em>.</p>

<h4 id="310-puhelinluettelon-backend-osa-10">3.10 puhelinluettelon backend osa 10</h4>

<p>Vie sovelluksen backend internetiin, esim. Herokuun.</p>

<p><strong>Huom1</strong> komento <em>heroku</em> toimii laitoksen koneilla ja fuksikannettavilla 9.2. alkaen. Jos et jostain syystä saa asennettua herokua koneellesi, voit käyttää komentoa <a href="https://www.npmjs.com/package/heroku-cli">npx heroku-cli</a>.</p>

<p><strong>Huom2</strong> eihän hakemisto <em>build</em> ole gitignoroituna projektissasi?</p>

<p>Testaa selaimen ja postmanin tai VS Code REST clientin avulla, että internetissä oleva backend toimii.</p>

<p><strong>PRO TIP:</strong> kun deployaat sovelluksen herokuun, kannattaa ainakin alkuvaiheissa pitää <strong>KOKO AJAN</strong> näkyvillä herokussa olevan sovelluksen loki antamalla komento <code>heroku logs -t</code>:</p>

<p><img src="http://localhost:4000/assets/teht/22.png" alt="" /></p>

<p>Tee repositorion juureen tiedosto README.md ja lisää siihen linkki internetissä olevaan sovellukseesi.</p>

<h4 id="311-puhelinluettelo-full-stack">3.11 puhelinluettelo full stack</h4>

<p>Generoi frontendistä tuotantoversio ja lisää se internetissä olevaan sovellukseesi osan 3 <a href="/osa3/#staattisten-tiedostojen-tarjoaminen-backendistä">tapaa noudatellen</a></p>

<p>Huolehdi myös, että frontend toimii edelleen myös paikallisesti.</p>

<h3 id="mongoosen-alkeet">mongoosen alkeet</h3>

<div class="important">
Älä laita tietokannan salasanaa Githubiin!
</div>

<h4 id="312-tietokanta-komentoriviltä">3.12 tietokanta komentoriviltä</h4>

<p>Luo sovellukselle pilvessä oleva mongo mlabin avulla.</p>

<p>Tee projektihakemistoon tiedosto <em>mongo.js</em>, jonka avulla voit lisätä tietokantaan puhelinnumeroja sekä listata kaikki kannassa olevat numerot.</p>

<p><strong>Huom</strong> jos/kun laitat tiedoston Githubiin, älä laita tietokannan salasanaa mukaan!</p>

<p>Ohjelma toimii siten, että jos sille annetaan käynnistäessä kaksi komentoriviparametria, esim:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>node mongo.js Joulupukki 040-1234556
</code></pre></div></div>

<p>Ohjelma tulostaa</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lisätään henkilö Joulupukki numero 040-1234556 luetteloon
</code></pre></div></div>

<p>ja lisää uuden yhteystiedon tietokantaan. Huomaa, että jos nimi sisältää välilyöntejä, on se annettava hipsuissa:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>node mongo.js <span class="s2">"Arto Vihavainen"</span> 040-1234556
</code></pre></div></div>

<p>Jos komentoriviparametreja ei anneta, eli ohjelma suoritetaan komennolla</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>node mongo.js
</code></pre></div></div>

<p>tulostaa ohjelma tietokannassa olevat numerotiedot:</p>

<pre>
puhelinluettelo:
Pekka Mikkola 040-1234556
Arto Vihavainen 045-1232456
Tiina Niklander 040-1231236
</pre>

<p>Saat selville ohjelman komentoriviparametrit muuttujasta <a href="https://nodejs.org/docs/latest-v8.x/api/process.html#process_process_argv">process.argv</a></p>

<p><strong>HUOM: älä sulje tietokantayhteyttä väärässä kohdassa</strong>. Esim. seuraava koodi ei toimi</p>

<pre><code class="language-ja">Person
  .find({})
  .then(persons=&gt; {
    // ...
  })

mongoose.connection.close()
</code></pre>

<p>Koodin suoritus nimittäin etenee siten, että heti operaation <em>Person.find</em> käynnistymisen jälkeen suoritetaan komento <em>mongoose.connection.close()</em> ja tietokantayhteys katkeaa välittömästi. Näin ei koskaan päästä siihen pisteeseen, että <em>Person.find</em>-operaation valmistumisen käsittelevää <em>takaisinkutsufunktiota</em> kutsuttaisiin.</p>

<p>Oikea paikka tietokantayhteyden sulkemiselle on takaisinkutsufunktion loppu:</p>

<pre><code class="language-ja">Person
  .find({})
  .then(persons=&gt; {
    // ...
    mongoose.connection.close()
  })
</code></pre>

<p><strong>HUOM2</strong> jos määrittelet modelin nimeksi <em>Person</em>, muuttaa mongoose sen monikkomuotoon <em>people</em>, jota se käyttää vastaavan kokoelman nimenä.</p>

<h3 id="backend-ja-tietokanta">backend ja tietokanta</h3>

<p>Seuraavat tehtävät saattavat olla melko suoraviivaisia, tosin jos frontend-koodissasi sattuu olemaan bugeja tai epäyhteensopivuutta backendin kanssa, voi seurauksena olla myös mielenkiintoisia bugeja.</p>

<h4 id="313-puhelinluettelo-ja-tietokanta-osa-1">3.13 puhelinluettelo ja tietokanta, osa 1</h4>

<p>Muuta backendin kaikkien puhelintietojen näyttämistä siten, että se hakee näytettävät puhelintiedot tietokannasta.</p>

<p>Varmista, että frontend toimii muutosten jälkeen.</p>

<p>Tee tässä ja seuraavissa tehtävissä mongoose-spesifinen koodi omaan moduuliin samaan tapaan kuin osan 3 luvussa <a href="/osa3#tietokantamäärittelyjen-eriyttäminen-omaksi-moduuliksi">tietokantamäärittelyjen eriyttäminen omaksi moduuliksi</a></p>

<h4 id="314-puhelinluettelo-ja-tietokanta-osa-2">3.14* puhelinluettelo ja tietokanta, osa 2</h4>

<p>Osan 3 materiaalissa määriteltiin metodi <em>formatNote</em> jonka avulla tietokannasta haettu muistiinpano formatoidaan HTTP-pyyntöjen vastauksiin sopivaan muotoon:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">formatNote</span> <span class="o">=</span> <span class="p">(</span><span class="nx">note</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">content</span><span class="p">:</span> <span class="nx">note</span><span class="p">.</span><span class="nx">content</span><span class="p">,</span>
    <span class="na">date</span><span class="p">:</span> <span class="nx">note</span><span class="p">.</span><span class="nx">date</span><span class="p">,</span>
    <span class="na">important</span><span class="p">:</span> <span class="nx">note</span><span class="p">.</span><span class="nx">important</span><span class="p">,</span>
    <span class="na">id</span><span class="p">:</span> <span class="nx">note</span><span class="p">.</span><span class="nx">_id</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Refaktoroi koodiasi siten, että määrittelet formatoinnin suorittavan metodin mongoose skeeman <a href="http://mongoosejs.com/docs/guide.html#statics">staattisena metodina</a>, jolloin voit käyttää sitä koodista seuraavasti:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">persons</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">Person</span><span class="p">.</span><span class="nx">format</span><span class="p">)</span>
</code></pre></div></div>

<p>muotoillessa taulukossa <em>persons</em> olevat oliot tai yksittäsen olion <em>person</em> muotoilussa seuraavasti:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Person</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="nx">person</span><span class="p">)</span>
</code></pre></div></div>

<p>Tehtävän tekeminen edellyttää luovaa manuaalin lukemista. Älä juutu tähän ainakaan aluksi liian pitkäksi aikaa!</p>

<h4 id="315-puhelinluettelo-ja-tietokanta-osa-3">3.15 puhelinluettelo ja tietokanta, osa 3</h4>

<p>Muuta backendiä siten, että uudet numerot tallennetaan tietokantaan. Tässä vaiheessa voit olla välittämättä siitä, onko tietokannassa jo henkilöä jolla on sama nimi kuin lisättävällä.</p>

<p>Varmista, että frontend toimii muutosten jälkeen.</p>

<h3 id="lisää-operaatiota">lisää operaatiota</h3>

<p><strong>HUOM:</strong> vaikka et jostain syystä käsittelisikään promiseihin liittyviä virhetilanteita, on viisasta rekisteröidä promiseille virheenkäsittelijä, joka tulostaa virheen syyn konsoliin:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span>
  <span class="c1">// ...</span>
<span class="p">})</span>
</code></pre></div></div>

<p>näin vältyt monilta ikäviltä yllätyksiltä. Ja muistathan pitää <em>koko ajan</em> silmällä mitä konsolissa tapahtuu…</p>

<h4 id="316-puhelinluettelo-ja-tietokanta-osa-4">3.16 puhelinluettelo ja tietokanta, osa 4</h4>

<p>Muuta backendiä siten, että numerotietojen poistaminen päivittyy tietokantaan.</p>

<p>Varmista, että frontend toimii muutosten jälkeen.</p>

<h4 id="317-puhelinluettelo-ja-tietokanta-osa-5">3.17* puhelinluettelo ja tietokanta, osa 5</h4>

<p>Jos frontendissä annetaan numero henkilölle, joka on jo olemassa, päivittää frontend tiedot uudella tekemällä HTTP PUT -pyynnön henkilön tietoja vastaavaan url:iin.</p>

<p>Laajenna backendisi käsittelemään tämä tilanne.</p>

<p>Varmista, että frontend toimii muutosten jälkeen.</p>

<h4 id="318-puhelinluettelo-ja-tietokanta-osa-6">3.18* puhelinluettelo ja tietokanta, osa 6</h4>

<p>Päivitä myös polkujen <em>api/persons/:id</em> ja <em>info</em> käsittely, ja varmista niiden toimivuus suoraan selaimella, postmanilla tai VS Coden REST clientillä.</p>

<p>Selaimella tarkastellen yksittäisen numerotiedon tulisi näyttää seuraavalta:</p>

<p><img src="http://localhost:4000/images/teht/22b.png" alt="" /></p>

<h3 id="loppuhuipennus">loppuhuipennus</h3>

<h4 id="319-puhelinluettelo-ja-tietokanta-osa-7">3.19* puhelinluettelo ja tietokanta, osa 7</h4>

<p>Huolehdi, että backendiin voi lisätä yhdelle nimelle ainoastaan yhden numeron. Frontendin nykyisestä versiosta ei duplikaatteja voi luoda, mutta suoraan Postmanilla tai VS Coden REST clientillä se onnistuu.</p>

<p>Jos HTTP POST -pyyntö yrittää lisätä nimeä, joka on jo puhelinluettelossa, tulee vastata sopivalla statuskoodilla ja lisätä vastaukseen asianmukainen virheilmoitus.</p>

<p>Tehtävän voi tehdä muutamallakin eri tekniikalla. Koska todennäköisesti tarvitset tehtävässä useampaa tietokantaoperaatiota, tulee huomioida operaatioiden asynkroninen luonne:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Person</span>
  <span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="na">name</span><span class="p">:</span> <span class="nx">nameToBeAdded</span><span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">result</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// jatka koodia täällä</span>
  <span class="p">})</span>

<span class="c1">// tänne ei kannata koodia kirjoittaa...</span>
</code></pre></div></div>

<p>Operaatioita ei siis voi kirjoittaa “peräkkäin”. Eräs tapa siisteyttää suoraviivaista “sisäkkäisten callbackien” käyttöä on materiaalissakin esitetty promisejen ketjutus.</p>

<p>Tämä tehtävä saattaa olla jossain määrin hankala, älä juutu tehtävään liian pitkäksi aikaa!</p>

<p>Tutustumme seuraavassa osassa async/await-tekniikkaan, minkä avulla tämäkin tehtävä on helppo tehdä. On kuitenkin erittäin hyödyllistä opetella operoimaan myös suoraan promisejen tasolla.</p>

<p>Mielenkiintoinen mutta enemmän omatoimista opiskelua edellyttävä tapa toiminnallisuuden toteuttamiseen on <a href="http://mongoosejs.com/docs/validation.html">mongoosen validaatioiden</a> hyödyntäminen, tällöin riittää yhden asynkronisen operaation suorittaminen.</p>

<h4 id="320-tietokantaa-käyttävä-versio-herokuun">3.20 tietokantaa käyttävä versio herokuun</h4>

<p>Generoi päivitetystä sovelluksesta “full stack”-versio, eli tee frontendista uusi production build ja kopioi se backendin repositorioon. Varmista että kaikki toimii paikallisesti käyttämällä koko sovellusta backendin osoitteesta <a href="https://localhost:3001">https://localhost:3001</a>.</p>

<p>Pushaa uusi versio herokuun ja varmista, että kaikki toimii myös siellä.</p>

<h4 id="321-eriytetty-sovelluskehitys--ja-tuotantotietokanta">3.21* eriytetty sovelluskehitys- ja tuotantotietokanta</h4>

<p>Eriytä sovelluskehityksessä ja herokussa käytettävät tietokannat osan 3 lukua <a href="/osa3#sovelluksen-vieminen-tuotantoon">sovelluksen vieminen tuotantoon</a> noudattaen.</p>

<h3 id="eslint">ESlint</h3>

<h4 id="322-lint-konfiguraatio">3.22 lint-konfiguraatio</h4>

<p>Ota sovellukseesi käyttöön ESlint.</p>

<h3 id="tehtävien-palautus-3">Tehtävien palautus</h3>

<p>Palauta tehtävät <a href="https://studies.cs.helsinki.fi/fs-stats/">palautussovellukseen</a>.</p>

<h2 id="osa-4">Osa 4</h2>

<p>Deadline 25.2. klo 23:59</p>

<p>Osassa on 21 tehtävää, joista “pakollisia” on 11. On suositeltavaa että etenet seuraavaan osaan vasta kun olet tehnyt kaikki pakolliset tehtävät. Palautuksen tekemisen jälkeen et voi enää palauttaa osan tehtäviä.</p>

<p>Rakennamme tämän osan tehtävissä <em>blogilistasovellusta</em>, jonka avulla käyttäjien on mahdollista tallettaa tietoja internetistä löytämistään mielenkiintoisista blogeista. Kustakin blogista talletetaan sen kirjoittaja (author), aihe (title), url sekä blogilistasovelluksen käyttäjien antamien äänien määrä.</p>

<p>Lopullisen version palauttaminen riittää, voit toki halutessasi tehdä commitin jokaisen tehtävän jälkeisestä tilanteesta, mutta se ei ole välttämätöntä.</p>

<p>Blogilistasovellus muistuttaa huomattavasti syksyn ohjelmistotuotantokurssin miniprojekteissa tehtyä <a href="https://github.com/mluukkai/ohjelmistotuotanto2017/wiki/miniprojekti-speksi">ohjelmistoa</a>.</p>

<div class="important">

<p>Ennen kun teet tehtäviä, on enemmän kuin suositeltavaa, että käyt huolellisesti läpi <a href="https://fullstack-hy.github.io/osa4/">osan 4 materiaalin</a>. Tehtävien tekeminen ilman materiaalin lukemista tapahtuu täysin omalla vastuulla.</p>

</div>

<h3 id="sovelluksen-alustus-ja-rakenne">sovelluksen alustus ja rakenne</h3>

<h4 id="41-blogilista-osa-1">4.1 blogilista, osa 1</h4>

<p>Kuvitellaan tilanne, jossa saat sähköpostitse seuraavan, yhteen tiedostoon koodatun sovellusrungon:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">http</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'http'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'express'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">()</span>
<span class="kd">const</span> <span class="nx">bodyParser</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'body-parser'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">cors</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'cors'</span><span class="p">)</span>
<span class="kd">const</span> <span class="nx">mongoose</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'mongoose'</span><span class="p">)</span>

<span class="kd">const</span> <span class="nx">Blog</span> <span class="o">=</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">model</span><span class="p">(</span><span class="s1">'Blog'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">title</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
  <span class="na">author</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
  <span class="na">url</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
  <span class="na">likes</span><span class="p">:</span> <span class="nb">Number</span>
<span class="p">})</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">Blog</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">cors</span><span class="p">())</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">bodyParser</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>

<span class="kd">const</span> <span class="nx">mongoUrl</span> <span class="o">=</span> <span class="s1">'mongodb://localhost/bloglist'</span>
<span class="nx">mongoose</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">mongoUrl</span><span class="p">)</span>

<span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s1">'/api/blogs'</span><span class="p">,</span> <span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">Blog</span>
    <span class="p">.</span><span class="nx">find</span><span class="p">({})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">blogs</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">blogs</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">})</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/api/blogs'</span><span class="p">,</span> <span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">blog</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Blog</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span>

  <span class="nx">blog</span>
    <span class="p">.</span><span class="nx">save</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">result</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">201</span><span class="p">).</span><span class="nx">json</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">})</span>

<span class="kd">const</span> <span class="nx">PORT</span> <span class="o">=</span> <span class="mi">3003</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">PORT</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Server running on port </span><span class="p">${</span><span class="nx">PORT</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div>

<p>Tee sovelluksesta toimiva <em>npm</em>-projekti. Jotta sovelluskehitys olisi sujuvaa, konfiguroi sovellus suoritettavaksi <em>nodemon</em>:illa. Voit luoda sovellukselle uuden tietokannan esim. mlabiin tai käyttää edellisen osan sovelluksen tietokantaa.</p>

<p>Varmista, että sovellukseen on mahdollista lisätä blogeja Postmanilla tai VS Code REST clientilla, ja että sovellus näyttää lisätyt blogit.</p>

<h4 id="42-blogilista-osa-2">4.2 blogilista, osa 2</h4>

<p>Jaa sovelluksen koodi osan 4 <a href="/osa4">alun</a> tapaan useaan moduuliin.</p>

<p><strong>HUOM</strong> etene todella pienin askelin, varmistaen että kaikki toimii koko ajan. Jos yrität “oikaista” tekemällä monta asiaa kerralla, on <a href="https://fi.wikipedia.org/wiki/Murphyn_laki">Murphyn lain</a> perusteella käytännössä varmaa, että jokin menee pahasti pieleen ja “oikotien” takia maaliin päästään paljon myöhemmin kuin systemaattisin pienin askelin.</p>

<p>Paras käytänne on commitoida koodi aina stabiilissa tilanteessa, tällöin on helppo palata aina toimivaan tilanteeseen jos koodi menee liian solmuun.</p>

<h3 id="yksikkötestaus">yksikkötestaus</h3>

<p>Tehdään joukko blogilistan käsittelyyn tarkoitettuja apufunktioita. Tee funktiot esim. tiedostoon <em>utils/list_helper.js</em>. Tee testit sopivasti nimettyyn tiedostoon hakemistoon <em>tests</em>.</p>

<p><strong>HUOM:</strong> jos jokin testi ei mene läpi, ei kannata ongelmaa korjatessa suorittaa kaikkia testejä, vaan ainoastaan rikkinäistä testiä hyödyntäen <a href="https://facebook.github.io/jest/docs/en/api.html#testonlyname-fn-timeout">only</a>-metodia.</p>

<h4 id="43-apufunktioita-ja-yksikkötestejä-osa-1">4.3 apufunktioita ja yksikkötestejä, osa 1</h4>

<p>Määrittele ensin funktio <em>dummy</em> joka saa parametrikseen taulukollisen blogeja ja palauttaa aina luvun 1. Tiedoston <em>list_helper.js</em> sisällöksi siis tulee tässä vaiheessa</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">dummy</span> <span class="o">=</span> <span class="p">(</span><span class="nx">blogs</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">dummy</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Varmista testikonfiguraatiosi toimivuus seuraavalla testillä:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">listHelper</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'../utils/list_helper'</span><span class="p">)</span>

<span class="nx">test</span><span class="p">(</span><span class="s1">'dummy is called'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">blogs</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">listHelper</span><span class="p">.</span><span class="nx">dummy</span><span class="p">(</span><span class="nx">blogs</span><span class="p">)</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div>

<h4 id="44-apufunktioita-ja-yksikkötestejä-osa-2">4.4 apufunktioita ja yksikkötestejä, osa 2</h4>

<p>Määrittele funktio <em>totalLikes</em> joka saa parametrikseen taulukollisen blogeja. Funktio palauttaa blogien yhteenlaskettujen tykkäysten eli <em>likejen</em> määrän.</p>

<p>Määrittele funktiolle sopivat testit. Funktion testit kannattaa laittaa <em>describe</em>-lohkoon jolloin testien tulostus ryhmittyy miellyttävästi:</p>

<p><img src="http://localhost:4000/assets/teht/23.png" alt="" /></p>

<p>Testisyötteiden määrittely onnistuu esim. seuraavaan tapaan:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">describe</span><span class="p">(</span><span class="s1">'total likes'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">listWithOneBlog</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="na">_id</span><span class="p">:</span> <span class="s1">'5a422aa71b54a676234d17f8'</span><span class="p">,</span>
      <span class="na">title</span><span class="p">:</span> <span class="s1">'Go To Statement Considered Harmful'</span><span class="p">,</span>
      <span class="na">author</span><span class="p">:</span> <span class="s1">'Edsger W. Dijkstra'</span><span class="p">,</span>
      <span class="na">url</span><span class="p">:</span> <span class="s1">'http://www.u.arizona.edu/~rubinson/copyright_violations/Go_To_Considered_Harmful.html'</span><span class="p">,</span>
      <span class="na">likes</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
      <span class="na">__v</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">}</span>
  <span class="p">]</span>

  <span class="nx">test</span><span class="p">(</span><span class="s1">'when list has only one blog equals the likes of that'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">listHelper</span><span class="p">.</span><span class="nx">totalLikes</span><span class="p">(</span><span class="nx">listWithOneBlog</span><span class="p">)</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
  <span class="p">})</span>
<span class="p">})</span>
</code></pre></div></div>

<p>Jos et viitsi itse määritellä testisyötteenä käytettäviä blogeja, saat valmiin listan <a href="https://github.com/FullStack-HY/part3-notes-backend/wiki/blogs-for-testing">täältä</a></p>

<p>Törmäät varmasti testien tekemisen yhteydessä erinäisiin ongelmiin. Pidä mielessä osassa 3 käsitellyt <a href="osa3/#Node-sovellusten-debuggaaminen">debuggaukseen</a> liittyvät asiat, voit testejäkin suorittaessasi printtailla konsoliin komennolla <em>console.log</em></p>

<h4 id="45-apufunktioita-ja-yksikkötestejä-osa-3">4.5* apufunktioita ja yksikkötestejä, osa 3</h4>

<p>Määrittele funktio <em>favoriteBlog</em> joka saa parametrikseen taulukollisen blogeja. Funktio selvittää millä blogilla on eniten likejä. Jos suosikkeja on monta, riittää että funktio palauttaa niistä jonkun.</p>

<p>Paluuarvo voi olla esim. seuraavassa muodossa:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">title</span><span class="p">:</span> <span class="s2">"Canonical string reduction"</span><span class="p">,</span>
  <span class="nx">author</span><span class="p">:</span> <span class="s2">"Edsger W. Dijkstra"</span><span class="p">,</span>
  <span class="nx">likes</span><span class="p">:</span> <span class="mi">12</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Huom</strong>, että kun vertailet olioita, metodi <a href="https://facebook.github.io/jest/docs/en/expect.html#toequalvalue">toEqual</a> on todennäköisesti se mitä haluat käyttää sillä <a href="https://facebook.github.io/jest/docs/en/expect.html#tobevalue">toBe</a>-vertailu, joka sopii esim. lukujen ja merkkijonojen vertailuun vaatisi olioiden vertailussa, että oliot ovat samat, pelkkä saman sisältöisyys ei riitä.</p>

<p>Tee myös tämän ja seuraavien kohtien testit kukin oman <em>describe</em>-lohkon sisälle.</p>

<h4 id="46-apufunktioita-ja-yksikkötestejä-osa-4">4.6* apufunktioita ja yksikkötestejä, osa 4</h4>

<p>Tämä ja seuraava tehtävä ovat jo hieman haastavampia. Tehtävien tekeminen ei ole osan jatkon kannalta oleellista, eli voi olla hyvä idea palata näihin vasta kun muu osa on kahlattu läpi.</p>

<p>Määrittele funktio <em>mostBlogs</em> joka saa parametrikseen taulukollisen blogeja. Funktio selvittää <em>kirjoittajan</em>, kenellä on eniten blogeja. Funktion paluuarvo kertoo myös ennätysblogaajan blogien määrän:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">author</span><span class="p">:</span> <span class="s2">"Robert C. Martin"</span><span class="p">,</span>
  <span class="nx">blogs</span><span class="p">:</span> <span class="mi">3</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Jos ennätysblogaajia on monta, riittää että funktio palauttaa niistä jonkun.</p>

<h4 id="47-apufunktioita-ja-yksikkötestejä-osa-5">4.7* apufunktioita ja yksikkötestejä, osa 5</h4>

<p>Määrittele funktio <em>mostLikes</em> joka saa parametrikseen taulukollisen blogeja. Funktio selvittää kirjoittajan, kenen blogeilla on eniten likejä. Funktion paluuarvo kertoo myös suosikkiblogaajan likejen yhteenlasketun määrän:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">author</span><span class="p">:</span> <span class="s2">"Edsger W. Dijkstra"</span><span class="p">,</span>
  <span class="nx">likes</span><span class="p">:</span> <span class="mi">17</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Jos suosikkiblogaajia on monta, riittää että funktio palauttaa niistä jonkun.</p>

<h3 id="apin-testaaminen">API:n testaaminen</h3>

<p><strong>Huom</strong> materiaalissa käytetään muutamaan kertaan ekspektaatiota <a href="https://facebook.github.io/jest/docs/en/expect.html#tocontainitem">toContain</a> tarkastettaessa että jokin arvo on taulukossa. Kannattaa huomata, että metodi käyttää samuuden vertailuun ===-operaattoria ja olioiden kohdalla tämä ei ole useinkaan se mitä halutaan ja parempi vaihtoehto onkin <a href="https://facebook.github.io/jest/docs/en/expect.html#tocontainequalitem">toContainEqual</a>.</p>

<h4 id="48-blogilistan-testit-osa-1">4.8 blogilistan testit, osa 1</h4>

<p>Tee API-tason testit blogilistan osoitteeseen /api/blogs tapahtuvalle HTTP GET -pyynnölle.</p>

<p>Kun testi on valmis, refaktoroi operaatio käyttämään promisejen sijaan async/awaitia.</p>

<p>Huomaa, että joudut tekemään koodiin osan 4 materiaalin tyylin joukon muutoksia (mm. testausympäristön määrittely), jotta saat järkevästi määriteltyä API-tason testejä.</p>

<p><strong>Huom</strong> testien kehitysvaiheessa ei yleensä kannata suorittaa joka kerta kaikkia testejä, vaan keskittyä yhteen testiin kerrallaan. On useita tapoja, joilla voidaan rajoittaa jestin suorittamia testejä. Esim. komennolla</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npx jest <span class="nt">-t</span> <span class="s1">'blogs are returned'</span>
</code></pre></div></div>

<p>voidaan suorittaa ainoastaan ne testit, joiden nimessä esiintyy <em>blogs are returned</em>.</p>

<p>Yksittäisen testitiedoston sisällä olevien testien suoritusta voidaan kontrolloida metodeilla <em>skip</em> ja <em>only</em> <a href="https://facebook.github.io/jest/docs/en/api.html">ks. manuaali</a>.</p>

<p>Voimme esim. laittaa koko edellisessä tehtäväsarjassa tehdyt testit ison describen sisälle ja määritellä ne <a href="https://facebook.github.io/jest/docs/en/api.html#describeskipname-fn">skipattavaksi</a>:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">describe</span><span class="p">.</span><span class="nx">skip</span><span class="p">(</span><span class="s1">'list helpers'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">test</span><span class="p">(</span><span class="s1">'dummy is called'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">blogs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">listHelper</span><span class="p">.</span><span class="nx">dummy</span><span class="p">(</span><span class="nx">blogs</span><span class="p">)</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="p">})</span>

  <span class="nx">describe</span><span class="p">(</span><span class="s1">'total likes'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">test</span><span class="p">(</span><span class="s1">'of empty list is 0'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">listHelper</span><span class="p">.</span><span class="nx">totalLikes</span><span class="p">(</span><span class="nx">emptyList</span><span class="p">)</span>
      <span class="nx">expect</span><span class="p">(</span><span class="nx">result</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="c1">// ...</span>
  <span class="p">})</span>
<span class="p">})</span>
</code></pre></div></div>

<p>tällöin komennolla <em>npm test</em> suoritettaessa tiedoston testejä ei suoriteta ollenkaan.</p>

<p>Kun testit ovat stabiilissa tilassa, tulee skiptit ja onlyt poistaa.</p>

<h4 id="49-blogilistan-testit-osa-2">4.9 blogilistan testit, osa 2</h4>

<p>Tee testit blogin lisäämiselle, eli osoitteeseen /api/blogs tapahtuvalle HTTP POST -pyynnölle.</p>

<p>Kun testi on valmis, refaktoroi operaatio käyttämään promisejen sijaan async/awaitia.</p>

<h4 id="410-blogilistan-testit-osa-3">4.10* blogilistan testit, osa 3</h4>

<p>Tee testi joka varmistaa, että jos kentälle <em>likes</em> ei anneta arvoa, asetetaan sen arvoksi 0. Muiden kenttien sisällöstä ei tässä tehtävässä vielä välitetä.</p>

<p>Laajenna ohjelmaa siten, että testi menee läpi.</p>

<h4 id="411-blogilistan-testit-osa-4">4.11* blogilistan testit, osa 4</h4>

<p>Tee testit blogin lisäämiselle, eli osoitteeseen /api/blogs tapahtuvalle HTTP POST -pyynnölle, joka varmistaa, että jos uusi blogi ei sisällä kenttiä <em>title</em> ja <em>url</em>, pyyntöön vastataan statuskoodilla <em>400 Bad request</em></p>

<p>Laajenna toteutusta siten, että testit menevät läpi.</p>

<h3 id="varoitus">Varoitus</h3>

<p>Jos huomaat kirjoittavasi sekaisin async/awaitia ja <em>then</em>-kutsuja, on 99% varmaa, että teet jotain väärin. Käytä siis jompaa kumpaa tapaa, älä missään tapauksessa “varalta” molempia.</p>

<h3 id="lisää-toiminnallisuutta-ja-testejä">Lisää toiminnallisuutta ja testejä</h3>

<h4 id="412-blogilistan-laajennus-osa-1">4.12* blogilistan laajennus, osa 1</h4>

<p>Refaktoroi projektin testit siten, että ne eivät enää ole riippuvaisia siitä, että HTTP GET -operaatioiden testit suoritetaan ennen uusien blogien lisäämisen testaamista. Määrittele myös sopivia apumetodeja, joiden avulla saat poistettua testeistä copypastea:</p>

<p>Testit voivat tämän tehtävän jälkeen noudattaa esim. osan 4 luvun <a href="/osa4#testien-refaktorointi">Testien refaktorointi</a> tyyliä</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">helper</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./test_helper'</span><span class="p">)</span>

<span class="c1">// ...</span>

<span class="nx">test</span><span class="p">(</span><span class="s1">'a valid blog can be added'</span><span class="p">,</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">newBlog</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1">// ....</span>
  <span class="p">}</span>

  <span class="kd">const</span> <span class="nx">blogsBefore</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">helper</span><span class="p">.</span><span class="nx">blogsInDb</span><span class="p">()</span>

  <span class="kr">await</span> <span class="nx">api</span>
    <span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/api/blogs'</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">newBlog</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="mi">201</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">expect</span><span class="p">(</span><span class="s1">'Content-Type'</span><span class="p">,</span> <span class="sr">/application</span><span class="se">\/</span><span class="sr">json/</span><span class="p">)</span>

  <span class="kd">const</span> <span class="nx">blogsAfter</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">helper</span><span class="p">.</span><span class="nx">blogsInDb</span><span class="p">()</span>

  <span class="nx">expect</span><span class="p">(</span><span class="nx">blogsAfter</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="nx">blogsBefore</span><span class="p">.</span><span class="nx">length</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">blogsAfter</span><span class="p">).</span><span class="nx">toContainEqual</span><span class="p">(</span><span class="nx">newBlog</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div>

<h4 id="413-blogilistan-laajennus-osa-2">4.13 blogilistan laajennus, osa 2</h4>

<p>Toteuta sovellukseen mahdollisuus yksittäisen blogin poistoon.</p>

<p>Käytä async/awaitia. Noudata operaation HTTP-rajapinnan suhteen <a href="/osa3#rest">RESTful</a>-käytänteitä.</p>

<p>Saat toteuttaa ominaisuudelle testit jos haluat. Jos et, varmista ominaisuuden toimivuus esim. Postmanilla.</p>

<h4 id="414-blogilistan-laajennus-osa-3">4.14* blogilistan laajennus, osa 3</h4>

<p>Toteuta sovellukseen mahdollisuus yksittäisen blogin muokkaamiseen.</p>

<p>Käytä async/awaitia.</p>

<p>Tarvitsemme muokkausta lähinnä <em>likejen</em> lukumäärän päivittämiseen. Toiminnallisuuden voi toteuttaa samaan tapaan kuin muistiinpanon päivittäminen toteutettiin <a href="/osa3#loput-operaatiot">osassa 3</a>.</p>

<p>Saat toteuttaa ominaisuudelle testit jos haluat. Jos et, varmista ominaisuuden toimivuus esim. Postmanilla.</p>

<h3 id="blogilistan-käyttäjät">Blogilistan käyttäjät</h3>

<p>Seuraavien tehtävien myötä Blogilistalle luodaan käyttäjienhallinnan perusteet. Varminta on seurata melko tarkkaan osan 4 luvusta <a href="/osa4#käyttäjien-hallinta-ja-monimutkaisempi-tietokantaskeema">Käyttäjien hallinta ja monimutkaisempi tietokantaskeema</a> alkavaa tarinaa. Toki luovuus on sallittua.</p>

<h3 id="varoitus-vielä-kerran">Varoitus vielä kerran</h3>

<p>Jos huomaat kirjoittavasi sekaisin async/awaitia ja <em>then</em>-kutsuja, on 99% varmaa, että teet jotain väärin. Käytä siis jompaa kumpaa tapaa, älä missään tapauksessa “varalta” molempia.</p>

<h4 id="415-blogilistan-laajennus-osa-4">4.15 blogilistan laajennus, osa 4</h4>

<p>Tee sovellukseen mahdollisuus luoda käyttäjiä tekemällä HTTP POST -pyyntö osoitteeseen <em>api/users</em>. Käyttäjillä on käyttäjätunnus, salasana ja nimi sekä totuusarvoinen kenttä, joka kertoo onko käyttäjä täysi-ikäinen.</p>

<p>Älä talleta tietokantaan salasanoja selväkielisenä vaan käytä osan 4 luvun <a href="/osa4#käyttäjien-luominen">Käyttäjien luominen</a> tapaan <em>bcrypt</em>-kirjastoa.</p>

<p><strong>HUOM</strong> joillain windows-käyttäjillä on ollut ongelmia <em>bcrypt</em>:in kanssa. Jos törmäät ongelmiin, poista kirjasto komennolla</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm uninstall bcrypt <span class="nt">--save</span> 
</code></pre></div></div>

<p>ja asenna sen sijaan <a href="https://www.npmjs.com/package/bcryptjs">bcryptjs</a></p>

<p>Tee järjestelmään myös mahdollisuus katsoa kaikkien käyttäjien tiedot sopivalla HTTP-pyynnöllä.</p>

<p>Käyttäjien lista voi näyttää esim. seuraavalta:
<img src="https://raw.githubusercontent.com/mluukkai/mluukkai.github.io/master/assets/teht/24.png" alt="" /></p>

<h4 id="416-blogilistan-laajennus-osa-5">4.16* blogilistan laajennus, osa 5</h4>

<p>Laajenna käyttäjätunnusten luomista siten, että salasanan tulee olla vähintään 3 merkkiä pitkä ja käyttäjätunnus on järjestelmässä uniikki. Jos täysi-ikäisyydelle ei määritellä luotaessa arvoa, on se oletusarvoisesti true.</p>

<p>Luomisoperaation tulee palauttaa sopiva statuskoodi ja kuvaava virheilmoitus, jos yritetään luoda epävalidi käyttäjä.</p>

<p>Tee testit, jotka varmistavat, että virheellisiä käyttäjiä ei luoda, ja että virheellisen käyttäjän luomisoperaatioon vastaus on järkevä statuskoodin ja virheilmoituksen osalta.</p>

<h4 id="417-blogilistan-laajennus-osa-6">4.17 blogilistan laajennus, osa 6</h4>

<p>Laajenna blogia siten, että blogiin tulee tieto sen lisänneestä käyttäjästä.</p>

<p>Muokkaa blogien lisäystä osan 4 luvun <a href="/osa4/#populate">populate</a> tapaan siten, että blogin lisäämisen yhteydessä määritellään blogin lisääjäksi <em>joku</em> järjestelmän tietokannassa olevista käyttäjistä (esim. ensimmäisenä löytyvä). Tässä vaiheessa ei ole väliä kuka käyttäjistä määritellään lisääväksi. Toiminnallisuus viimeistellään tehtävässä 4.19.</p>

<p>Muokaa kaikkien blogien listausta siten, että blogien yhteydessä näytetään lisääjän tiedot:</p>

<p><img src="https://raw.githubusercontent.com/mluukkai/mluukkai.github.io/master/assets/teht/25.png" alt="" /></p>

<p>ja käyttäjien listausta siten että käyttäjien lisäämät blogit ovat näkyvillä</p>

<p><img src="http://localhost:4000/assets/teht/26.png" alt="" /></p>

<h4 id="418-blogilistan-laajennus-osa-7">4.18 blogilistan laajennus, osa 7</h4>

<p>Toteuta osan 4 luvun <a href="/osa4#kirjautuminen">Kirjautuminen</a> tapaan järjestelmään token-perustainen autentikointi.</p>

<h4 id="419-blogilistan-laajennus-osa-8">4.19 blogilistan laajennus, osa 8</h4>

<p>Muuta blogien lisäämistä siten, että se on mahdollista vain, jos lisäyksen tekevässä HTTP POST -pyynnössä on mukana validi token. Tokenin haltija määritellään blogin lisääjäksi.</p>

<h4 id="420-blogilistan-laajennus-osa-9">4.20* blogilistan laajennus, osa 9</h4>

<p>Osan 4 <a href="/osa4#kirjautuminen">esimerkissä</a> token otetaan headereista apufunktion <em>getTokenFrom</em> avulla.</p>

<p>Jos käytit samaa ratkaisua, refaktoroi tokenin erottaminen <a href="/osa3#middlewaret">middlewareksi</a>, joka ottaa tokenin <em>Authorization</em>-headerista ja sijoittaa sen <em>request</em>-olion kenttään <em>token</em>.</p>

<p>Eli kun rekisteröit middlewaren ennen routeja tiedostossa <em>index.js</em></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">middleware</span><span class="p">.</span><span class="nx">tokenExtractor</span><span class="p">)</span>
</code></pre></div></div>

<p>pääsevät routet tokeniin käsiksi suoraan viittaamalla <em>request.token</em>:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">blogsRouter</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// ..</span>
  <span class="kd">const</span> <span class="nx">decodedToken</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">verify</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">token</span><span class="p">,</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SECRET</span><span class="p">)</span>
  <span class="c1">// ..</span>
<span class="p">})</span>
</code></pre></div></div>

<h4 id="421-blogilistan-laajennus-osa-9">4.21* blogilistan laajennus, osa 9</h4>

<p>Muuta blogin poistavaa operaatiota siten, että poisto onnistuu ainoastaan jos poisto-operaation tekijä (eli se kenen token on pyynnön mukana) on sama kuin blogin lisääjä.</p>

<p>Jos poistoa yritetään ilman tokenia tai väärän käyttäjän toimesta, tulee operaation palauttaa asiaan kuuluva statuskoodi.</p>

<p>Huomaa, että jos haet blogin tietokannasta</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">blog</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">Blog</span><span class="p">.</span><span class="nx">findById</span><span class="p">(...)</span>
</code></pre></div></div>

<p>ei kenttä <em>blog.user</em> ole tyypiltään merkkijono vaan <em>object</em>. Eli jos haluat verrata kannasta haetun olion id:tä merkkijonomuodossa olevaan id:hen, ei normaali vertailu toimi. Kannasta haettu id tulee muuttaa vertailua varten merkkijonoksi:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span> <span class="nx">blog</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span> <span class="o">===</span> <span class="nx">userid</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span> <span class="p">)</span> <span class="p">...</span>
</code></pre></div></div>

<h3 id="tehtävien-palautus-4">Tehtävien palautus</h3>

<p>Palauta tehtävät <a href="https://studies.cs.helsinki.fi/fs-stats/">palautussovellukseen</a>.</p>

<h2 id="osa-5">Osa 5</h2>

<p>Deadline 4.3. klo 23:59</p>

<p>Osassa on 21 tehtävää, joista “pakollisia” on 11. On suositeltavaa että etenet seuraavaan osaan vasta kun olet tehnyt kaikki pakolliset tehtävät.  Palautuksen tekemisen jälkeen et voi enää palauttaa osan tehtäviä.</p>

<p>Teemme nyt edellisen osan tehtävissä tehtyä bloglist-backendia käyttävän frontendin. Voit ottaa tehtävien pohjaksi <a href="https://github.com/FullStack-HY/bloglist-frontend">Githubista</a> olevan sovellusrungon. Sovellus olettaa, että backend on käynnissä koneesi portissa 3003.
Lopullisen version palauttaminen riittää, voit toki halutessasi tehdä commitin jokaisen tehtävän jälkeisestä tilanteesta, mutta se ei ole välttämätöntä.</p>

<p>Tämän osan alun tehtävät käytännössä kertaavat kaiken oleellisen tämän kurssin puitteissa Reactista läpikäydyn asian ja voivat siinä mielessä olla kohtuullisen haastavia, erityisesti jos edellisen osan tehtävissä toteuttamasi backend toimii puutteellisesti. Saattaakin olla varminta siirtyä käyttämään osan 4 mallivastauksen backendia.</p>

<p>Muista tehtäviä tehdessäsi kaikki debuggaukseen liittyvät käytänteet, erityisesti konsolin tarkkailu.</p>

<div class="important">

<p>Ennen kun teet tehtäviä, on enemmän kuin suositeltavaa, että käyt huolellisesti läpi <a href="https://fullstack-hy.github.io/osa5/">osan 5 materiaalin</a>. Tehtävien tekeminen ilman materiaalin lukemista tapahtuu täysin omalla vastuulla.</p>

</div>

<h3 id="varoitus-1">Varoitus</h3>

<p>Jos huomaat kirjoittavasi sekaisin async/awaitia ja <em>then</em>-kutsuja, on 99.9% varmaa, että teet jotain väärin. Käytä siis jompaa kumpaa tapaa, älä missään tapauksessa “varalta” molempia.</p>

<h3 id="kirjautuminen-ja-blogien-luonti">kirjautuminen ja blogien luonti</h3>

<h4 id="51-blogilistan-frontend-osa-1">5.1 blogilistan frontend, osa 1</h4>

<p>Ota tehtävien pohjaksi <a href="https://github.com/FullStack-HY/bloglist-frontend">Githubissa</a> olevan sovellusrungo kloonaamalla se sopivaan paikkaan komennolla</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone git@github.com:FullStack-HY/bloglist-frontend.git
</code></pre></div></div>

<p>Jos kloonaat projektin olemassaolevan git-reposition sisälle, <em>poista kloonatun sovelluksen git-konfiguraatio</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>bloglist-frontend   // eli mene ensin kloonatun repositorion hakemistoon
rm <span class="nt">-rf</span> .git
</code></pre></div></div>

<p>Sovellus käynnistyy normaaliin tapaan, mutta joudut ensin asentamaan sovelluksen riippuvuudet:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm install
npm start
</code></pre></div></div>

<p>Toteuta frontendiin kirjautumisen mahdollistava toiminnallisuus. Kirjautumisen yhteydessä backendin palauttama <em>token</em> tallennetaan sovelluksen tilan kenttään <em>user</em>.</p>

<p>Jos käyttäjä ei ole kirjautunut, sivulla näytetään <em>pelkästään</em> kirjautumislomake:</p>

<p><img src="http://localhost:4000/assets/teht/27.png" alt="" /></p>

<p>Kirjautuneelle käyttäjälle näytetään kirjautuneen käyttäjän nimi sekä blogien lista</p>

<p><img src="http://localhost:4000/assets/teht/28.png" alt="" /></p>

<p>Tässä vaiheessa kirjautuneiden käyttäjien tietoja ei vielä tarvitse muistaa local storagen avulla.</p>

<p><strong>HUOM</strong> Voit tehdä kirjautumislomakkeen ehdollisen renderöinnin esim. seuraavasti:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">user</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Kirjaudu sovellukseen<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">form</span><span class="p">&gt;</span>
          //...
        <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>blogs<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
      <span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">blogs</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">blog</span> <span class="o">=&gt;</span>
        <span class="p">&lt;</span><span class="nc">Blog</span> <span class="na">key=</span><span class="si">{</span><span class="nx">blog</span><span class="p">.</span><span class="nx">_id</span><span class="si">}</span> <span class="na">blog=</span><span class="si">{</span><span class="nx">blog</span><span class="si">}</span> <span class="p">/&gt;</span>
      <span class="p">)</span><span class="si">}</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="52-blogilistan-frontend-osa-2">5.2 blogilistan frontend, osa 2</h4>

<p>Tee kirjautumisesta “pysyvä” local storagen avulla. Tee sovellukseen myös mahdollisuus uloskirjautumiseen</p>

<p><img src="http://localhost:4000/assets/teht/29.png" alt="" /></p>

<p>Uloskirjautumisen jälkeen selain ei saa muistaa kirjautunutta käyttäjää reloadauksen jälkeen.</p>

<h4 id="53-blogilistan-frontend-osa-3">5.3 blogilistan frontend, osa 3</h4>

<p>Laajenna sovellusta siten, että kirjautunut käyttäjä voi luoda uusia blogeja:</p>

<p><img src="http://localhost:4000/assets/teht/30.png" alt="" /></p>

<p>Bloginluomislomakkeesta voi tehdä oman komponenttinsa, joka hallitsee lomakkeen kenttien sisältöä tilansa avulla. Kaiken blogin luomiseen liittyvän tilan voi toki tallettaa myös <em>App</em>-komponenttiin.</p>

<h4 id="54-blogilistan-frontend-osa-4">5.4* blogilistan frontend, osa 4</h4>

<p>Toteuta sovellukseen notifikaatiot, jotka kertovat sovelluksen yläosassa onnistuneista ja epäonnistuneista toimenpiteistä. Esim. blogin lisäämisen yhteydessä voi antaa seuraavan notifikaation</p>

<p><img src="http://localhost:4000/assets/teht/32.png" alt="" /></p>

<p>epäonnistunut kirjautuminen taas johtaa notifikaatioon</p>

<p><img src="http://localhost:4000/assets/teht/31.png" alt="" /></p>

<p>Notifikaation tulee olla näkyvillä muutaman sekunnin ajan. Värien lisääminen ei ole pakollista.</p>

<h3 id="komponenttien-näyttäminen-vain-tarvittaessa">komponenttien näyttäminen vain tarvittaessa</h3>

<h4 id="55-blogilistan-frontend-osa-5">5.5 blogilistan frontend, osa 5</h4>

<p>Tee blogin luomiseen käytettävästä lomakkeesta ainoastaan tarvittaessa näytettävä osan 5 luvun <a href="/osa5#kirjautumislomakkeen-näyttäminen-vain-tarvittaessa">Kirjautumislomakkeen näyttäminen vain tarvittaessa</a> tapaan. Voit halutessasi hyödyntää osassa 5 määriteltyä komponenttia <em>Togglable</em>.</p>

<h4 id="56-blogilistan-frontend-osa-6">5.6* blogilistan frontend, osa 6</h4>

<p>Laajenna blogien listausta siten, että klikkaamalla blogin nimeä, sen täydelliset tiedot aukeavat</p>

<p><img src="http://localhost:4000/assets/teht/33.png" alt="" /></p>

<p>Uusi klikkaus blogin nimeen pienentää näkymän.</p>

<p>Napin <em>like</em> ei tässä vaiheessa tarvitse tehdä mitään.</p>

<p>Kuvassa on myös käytetty hieman CSS:ää parantamaan sovelluksen ulkoasua.</p>

<p>Tyylejä voidaan määritellä osan 5 tapaan helposti <a href="https://react-cn.github.io/react/tips/inline-styles.html">inline</a>-tyyleinä seuraavasti:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">Blog</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="c1">// ...</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// ..</span>

    <span class="kd">const</span> <span class="nx">blogStyle</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">paddingTop</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="na">paddingLeft</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="na">border</span><span class="p">:</span> <span class="s1">'solid'</span><span class="p">,</span>
      <span class="na">borderWidth</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="na">marginBottom</span><span class="p">:</span> <span class="mi">5</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style=</span><span class="si">{</span><span class="nx">blogStyle</span><span class="si">}</span><span class="p">&gt;</span>
        ...
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="varoitus-vielä-kerran-1">Varoitus vielä kerran</h3>

<p>Jos huomaat kirjoittavasi sekaisin async/awaitia ja <em>then</em>-kutsuja, on 99.9% varmaa, että teet jotain väärin. Käytä siis jompaa kumpaa tapaa, älä missään tapauksessa “varalta” molempia.</p>

<h4 id="57-blogilistan-frontend-osa-7">5.7* blogilistan frontend, osa 7</h4>

<p>Toteuta like-painikkeen toiminnallisuus. Like lisätään backendiin blogin yksilöivään urliin tapahtuvalla <em>PUT</em>-pyynnöllä.</p>

<p>Koska backendin operaatio korvaa aina koko blogin, joudut lähettämään operaation mukana blogin kaikki kentät, eli jos seuraavaa blogia liketetään</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">_id</span><span class="p">:</span> <span class="s2">"5a43fde2cbd20b12a2c34e91"</span><span class="p">,</span>
  <span class="nx">user</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="s2">"5a43e6b6c37f3d065eaaa581"</span><span class="p">,</span>
    <span class="nx">username</span><span class="p">:</span> <span class="s2">"mluukkai"</span><span class="p">,</span>
    <span class="nx">name</span><span class="p">:</span> <span class="s2">"Matti Luukkainen"</span>
  <span class="p">},</span>
  <span class="nx">likes</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="nx">author</span><span class="p">:</span> <span class="s2">"Joel Spolsky"</span><span class="p">,</span>
  <span class="nx">title</span><span class="p">:</span> <span class="s2">"The Joel Test: 12 Steps to Better Code"</span><span class="p">,</span>
  <span class="nx">url</span><span class="p">:</span> <span class="s2">"https://www.joelonsoftware.com/2000/08/09/the-joel-test-12-steps-to-better-code/"</span>
<span class="p">},</span>
</code></pre></div></div>

<p>tulee palvelimelle tehdä PUT-pyyntö osoitteeseen <em>/api/blogs/5a43fde2cbd20b12a2c34e91</em> ja sisällyttää pyynnön mukaan seuraava data:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">user</span><span class="p">:</span> <span class="s2">"5a43e6b6c37f3d065eaaa581"</span><span class="p">,</span>
  <span class="nx">likes</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="nx">author</span><span class="p">:</span> <span class="s2">"Joel Spolsky"</span><span class="p">,</span>
  <span class="nx">title</span><span class="p">:</span> <span class="s2">"The Joel Test: 12 Steps to Better Code"</span><span class="p">,</span>
  <span class="nx">url</span><span class="p">:</span> <span class="s2">"https://www.joelonsoftware.com/2000/08/09/the-joel-test-12-steps-to-better-code/"</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="58-blogilistan-frontend-osa-8">5.8* blogilistan frontend, osa 8</h4>

<p>Järjestä sovellus näyttämään blogit <em>likejen</em> mukaisessa suuruusjärjestyksessä. Järjestäminen onnistuu taulukon metodilla <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort">sort</a>.</p>

<h4 id="59-blogilistan-frontend-osa-9">5.9* blogilistan frontend, osa 9</h4>

<p>Lisää nappi blogin poistamiselle.</p>

<p>Toteuta myös poiston tekevä logiikka. Laajenna backendiä siten, että ne blogit, joihin ei liity lisääjää (joita syntyi ennen kun olimme lisänneet järjestelmään käyttäjiä), ovat kaikkien kirjautuneiden käyttäjien poistettavissa.</p>

<p>Ohjelmasi voi näyttää esim. seuraavalta:</p>

<p><img src="http://localhost:4000/assets/teht/34.png" alt="" /></p>

<p>Kuvassa näkyvä poiston varmistus on helppo toteuttaa funktiolla
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/confirm">window.confirm</a>.</p>

<h4 id="510-blogilistan-frontend-osa-10">5.10* blogilistan frontend, osa 10</h4>

<p>Näytä poistonappi ainoastaan jos kyseessä on kirjautuneen käyttäjän lisäämä blogi <em>tai</em> blogi, jolle ei ole määritelty lisääjää (joita siis syntyi järjestelmään ennen käyttäjien olemassaoloa).</p>

<h3 id="proptypet">PropTypet</h3>

<h4 id="511-blogilistan-frontend-osa-11">5.11 blogilistan frontend, osa 11</h4>

<p>Määrittele joillekin sovelluksesi komponenteille PropTypet.</p>

<h3 id="komponenttien-testaaminen">komponenttien testaaminen</h3>

<p><strong>HUOM:</strong> jos jokin testi on rikki, ei kannata ongelmaa korjatessa suorittaa kaikkia testejä, vaan ainoastaan rikkinäistä testiä hyödyntäen <a href="https://facebook.github.io/jest/docs/en/api.html#testonlyname-fn-timeout">only</a>-metodia.</p>

<p><strong>HUOM2:</strong> älä aliarvioi testissä tapahtuvan <em>console.logauksen</em> hyödyllisyyttä! Normaalissa koodauksessa console.log on elintärkeä, testauksessa se on välillä suorastaan välttämätön sillä testejä suorittaessa et saa mistään muualta feedbackiä.</p>

<p>Testejä suorittaessasi voit käyttää console.log-komentoja testeissä ja <em>sovelluksen koodissa</em>.</p>

<h4 id="512-blogilistan-testit-osa-1">5.12 blogilistan testit, osa 1</h4>

<p>Lisää sovellukseesi tilapäisesti seuraava komponentti</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="s1">'react'</span>

<span class="kd">const</span> <span class="nx">SimpleBlog</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">blog</span><span class="p">,</span> <span class="nx">onClick</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">(</span>
  <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="si">{</span><span class="nx">blog</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span> <span class="si">{</span><span class="nx">blog</span><span class="p">.</span><span class="nx">author</span><span class="si">}</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
      blog has <span class="si">{</span><span class="nx">blog</span><span class="p">.</span><span class="nx">likes</span><span class="si">}</span> likes
      <span class="p">&lt;</span><span class="nt">button</span> <span class="na">onClick=</span><span class="si">{</span><span class="nx">onClick</span><span class="si">}</span><span class="p">&gt;</span>like<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">)</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">SimpleBlog</span>
</code></pre></div></div>

<p>Tee testi, joka varmistaa, että komponentti renderöi blogin titlen, authorin ja likejen määrän.</p>

<p>Lisää komponenttiin tarvittaessa testausta helpottavia CSS-luokkia.</p>

<h4 id="513-blogilistan-testit-osa-2">5.13* blogilistan testit, osa 2</h4>

<p>Tee testi, joka varmistaa, että jos komponentin <em>like</em>-nappia painetaan kahdesti, komponentin propsina saamaa tapahtumankäsittelijäfunktiota kutsutaan kaksi kertaa.</p>

<h4 id="514-blogilistan-testit-osa-3">5.14* blogilistan testit, osa 3</h4>

<p>Tee oman sovelluksesi komponentille <em>Blog</em> testit, jotka varmistavat, että oletusarvoisesti blogista on näkyvissä ainoastaan nimi ja kirjoittaja, ja että klikkaamalla niitä saadaan näkyviin myös muut osat blogin tiedoista.</p>

<p><strong>HUOM:</strong> tee testissä klikkaus <em>ennen</em> kuin haet tarkastettavan elementin muuttujaan,
eli tee komennot tässä järjestyksessä</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">it</span><span class="p">(</span><span class="s1">'after clicking name the details are displayed'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// haetaan klikattava osa komponentista</span>
  <span class="kd">const</span> <span class="nx">nameDiv</span> <span class="o">=</span> <span class="p">...</span>
  <span class="nx">nameDiv</span><span class="p">.</span><span class="nx">simulate</span><span class="p">(</span><span class="s1">'click'</span><span class="p">)</span>

  <span class="c1">// haetaan tarkastettava, eli detaljit sisältävä osa komponentista</span>
  <span class="kd">const</span> <span class="nx">contentDiv</span> <span class="o">=</span> <span class="p">...</span>
  <span class="nx">expect</span><span class="p">(</span><span class="nx">contentDiv</span><span class="p">...)</span>
<span class="p">})</span>
</code></pre></div></div>

<p><strong>väärä</strong> järjestys on siis seuraava</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">it</span><span class="p">(</span><span class="s1">'DOES NOT WORK'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">nameDiv</span> <span class="o">=</span> <span class="p">...</span>
  <span class="kd">const</span> <span class="nx">contentDiv</span> <span class="o">=</span> <span class="p">...</span>

  <span class="c1">// klikataan liian myöhään</span>
  <span class="nx">nameDiv</span><span class="p">.</span><span class="nx">simulate</span><span class="p">(</span><span class="s1">'click'</span><span class="p">)</span>

  <span class="nx">expect</span><span class="p">(</span><span class="nx">contentDiv</span><span class="p">...)</span>
<span class="p">})</span>
</code></pre></div></div>

<h3 id="integraatiotestaus">integraatiotestaus</h3>

<h4 id="515-blogilistan-testit-osa-4">5.15 blogilistan testit, osa 4</h4>

<p>Tee sovelluksesi integraatiotesti, joka varmistaa, että jos käyttäjä ei ole kirjautunut järjestelmään, näyttää sovellus ainoastaan kirjautumislomakkeen, eli yhtään blogia ei vielä renderöidä.</p>

<h4 id="516-blogilistan-testit-osa-5">5.16* blogilistan testit, osa 5</h4>

<p>Tee myös testi, joka varmistaa, että kun käyttäjä on kirjautuneena, blogit renderöityvät sivulle.</p>

<p><strong>Vihje 1:</strong></p>

<p>Kirjautuminen kannattaa toteuttaa manipuloimalla testeissä local storagea. Jos määrittelet testeille mock-localstoragen osan 5 materiaalia seuraten, voit käyttää testikoodissa local storagea seuraavasti:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">username</span><span class="p">:</span> <span class="s1">'tester'</span><span class="p">,</span>
  <span class="na">token</span><span class="p">:</span> <span class="s1">'1231231214'</span><span class="p">,</span>
  <span class="na">name</span><span class="p">:</span> <span class="s1">'Teuvo Testaaja'</span>
<span class="p">}</span>

<span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">'loggedBlogAppUser'</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">user</span><span class="p">))</span>
</code></pre></div></div>

<p><strong>Vihje 2:</strong></p>

<p>Jotta mockin palauttamat blogit renderöityvät, kannattaa komponentti <em>App</em> luoda <em>describe</em>-lohkossa. Voit noudattaa tämän ja edellisen tehtävän organisoinnissa esim. seuraavaa tapaa:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">describe</span><span class="p">(</span><span class="s1">'&lt;App /&gt;'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">app</span>

  <span class="nx">describe</span><span class="p">(</span><span class="s1">'when user is not logged'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="c1">// luo sovellus siten, että käyttäjä ei ole kirjautuneena</span>
    <span class="p">})</span>

    <span class="nx">it</span><span class="p">(</span><span class="s1">'only login form is rendered'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">app</span><span class="p">.</span><span class="nx">update</span><span class="p">()</span>
      <span class="c1">// ...</span>
    <span class="p">})</span>
  <span class="p">})</span>

  <span class="nx">describe</span><span class="p">(</span><span class="s1">'when user is logged'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="c1">// luo sovellus siten, että käyttäjä on kirjautuneena</span>
    <span class="p">})</span>

    <span class="nx">it</span><span class="p">(</span><span class="s1">'all notes are rendered'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">app</span><span class="p">.</span><span class="nx">update</span><span class="p">()</span>
      <span class="c1">// ...</span>
    <span class="p">})</span>
  <span class="p">})</span>
<span class="p">})</span>
</code></pre></div></div>

<h3 id="redux-unicafe">Redux-Unicafe</h3>

<p>Tehdään seuraavissa tehtävissä hieman muokattu redux-versio osan 1 tehtävien Unicafe-sovelluksesta. Sovellus voi näyttää esim. seuraavalta:</p>

<p><img src="http://localhost:4000/assets/teht/35.png" alt="" /></p>

<p>Haluttu toiminnallisuus lienee ilmeinen.</p>

<p>Voit ottaa halutessasi tehtävän pohjaksi koodin <a href="https://github.com/FullStack-HY/FullStack-Hy.github.io/wiki/unicafe-redux">täältä</a></p>

<h4 id="517-unicafe-revisited-osa-1">5.17 unicafe revisited, osa 1</h4>

<p>Ennen sivulla näkyvää toiminnallisuutta, toteutetaan storen edellyttämä toiminnallisuus.</p>

<p>Storeen täytyy tallettaa erikseen lukumäärä jokaisentyyppisestä palautteesta. Storen hallitsema tila on siis muotoa:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">good</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
  <span class="nx">ok</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
  <span class="nx">bad</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Seuraavassa on runko reducerille:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">initialState</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">good</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="na">ok</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="na">bad</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">counterReducer</span> <span class="o">=</span> <span class="p">(</span><span class="nx">state</span> <span class="o">=</span> <span class="nx">initialState</span><span class="p">,</span> <span class="nx">action</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">action</span><span class="p">)</span>
  <span class="k">switch</span> <span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="s1">'GOOD'</span><span class="p">:</span>
      <span class="k">return</span> <span class="nx">state</span>
    <span class="k">case</span> <span class="s1">'OK'</span><span class="p">:</span>
      <span class="k">return</span> <span class="nx">state</span>
    <span class="k">case</span> <span class="s1">'BAD'</span><span class="p">:</span>
      <span class="k">return</span> <span class="nx">state</span>
    <span class="k">case</span> <span class="s1">'ZERO'</span><span class="p">:</span>
      <span class="k">return</span> <span class="nx">state</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">state</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">counterReducer</span>
</code></pre></div></div>

<p>ja sen testien runko</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">deepFreeze</span> <span class="k">from</span> <span class="s1">'deep-freeze'</span>
<span class="k">import</span> <span class="nx">counterReducer</span> <span class="k">from</span> <span class="s1">'./reducer'</span>

<span class="nx">describe</span><span class="p">(</span><span class="s1">'unicafe reducer'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">initialState</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">good</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="na">ok</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="na">bad</span><span class="p">:</span> <span class="mi">0</span>
  <span class="p">}</span>

  <span class="nx">it</span><span class="p">(</span><span class="s1">'should return a proper initial state when called with undefined state'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">state</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="kd">const</span> <span class="nx">action</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">type</span><span class="p">:</span> <span class="s1">'DO_NOTHING'</span>
    <span class="p">}</span>

    <span class="kd">const</span> <span class="nx">newState</span> <span class="o">=</span> <span class="nx">counterReducer</span><span class="p">(</span><span class="kc">undefined</span><span class="p">,</span> <span class="nx">action</span><span class="p">)</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">newState</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">(</span><span class="nx">initialState</span><span class="p">)</span>
  <span class="p">})</span>

  <span class="nx">it</span><span class="p">(</span><span class="s1">'good is incremented'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">action</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">type</span><span class="p">:</span> <span class="s1">'GOOD'</span>
    <span class="p">}</span>
    <span class="kd">const</span> <span class="nx">state</span> <span class="o">=</span> <span class="nx">initialState</span>

    <span class="nx">deepFreeze</span><span class="p">(</span><span class="nx">state</span><span class="p">)</span>
    <span class="kd">const</span> <span class="nx">newState</span> <span class="o">=</span> <span class="nx">counterReducer</span><span class="p">(</span><span class="nx">state</span><span class="p">,</span> <span class="nx">action</span><span class="p">)</span>
    <span class="nx">expect</span><span class="p">(</span><span class="nx">newState</span><span class="p">).</span><span class="nx">toEqual</span><span class="p">({</span>
      <span class="na">good</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="na">ok</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="na">bad</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">})</span>
  <span class="p">})</span>
<span class="p">})</span>
</code></pre></div></div>

<p>Testit olettavat että reduceri on talletettu tiedostoon <em>reducer.js</em>.</p>

<p><strong>Toteuta reducer ja tee sille testit.</strong></p>

<p>Varmista testeissä <em>deep-freeze</em>-kirjaston avulla, että kyseessä on <em>puhdas funktio</em>. Huomaa, että valmiin ensimmäisen testin on syytä mennä läpi koska redux olettaa, että reduceri palauttaa järkevän alkutilan kun sitä kutsutaan siten että ensimmäinen parametri, eli aiempaa tilaa edustava <em>state</em> on <em>undefined</em>.</p>

<p>Aloita laajentamalla reduceria siten, että molemmat testeistä menevät läpi. Lisää tämän jälkeen loput testit ja niiden toteuttava toiminnallisuus.</p>

<p>Osan 2 luvun <a href="/osa2#Muistiinpanon-tärkeyden-muutos">Muistiinpanon tärkeyden muutos</a> olion kopiointiin liittyvät asiat saattavat olla hyödyksi.</p>

<h4 id="518-unicafe-revisited-osa-2">5.18 unicafe revisited, osa 2</h4>

<p>Toteuta sitten sovelluksen koko sen varsinainen toiminnallisuus.</p>

<p>Älä unohda, että joudut huolehtimaan siitä, että sovellus uudelleenrenderöi itsensä storen muutosten yhteydessä esim. seuraavasti:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const render <span class="o">=</span> <span class="o">()</span> <span class="o">=&gt;</span> <span class="o">{</span>
  ReactDOM.render<span class="o">(</span>&lt;App /&gt;, document.getElementById<span class="o">(</span><span class="s1">'root'</span><span class="o">))</span>
<span class="o">}</span>

render<span class="o">()</span>
store.subscribe<span class="o">(</span>render<span class="o">)</span>
</code></pre></div></div>

<h3 id="redux-anekdootit">redux-anekdootit</h3>

<p>Toteutetaan osan lopuksi versio toisesta ensimmäisen osan tehtävästä, anekdoottien äänestyssovelluksesta. Voit ottaa ratkaisusi pohjaksi repositoriossa <a href="https://github.com/FullStack-HY/redux-anecdotes">https://github.com/FullStack-HY/redux-anecdotes</a> olevan projektin.</p>

<p>Jos kloonaat projektin olemassaolevan git-reposition sisälle, <em>poista kloonatun sovelluksen git-konfiguraatio</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>redux-anecdotes   // eli mene ensin kloonatun repositorion hakemistoon
rm <span class="nt">-rf</span> .git
</code></pre></div></div>

<p>Sovellus käynnistyy normaaliin tapaan, mutta joudut ensin asentamaan sovelluksen riippuvuudet:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm install
npm start
</code></pre></div></div>

<p>Sovelluksen lopullisen version tulisi näyttää seuraavalta:</p>

<p><img src="http://localhost:4000/assets/teht/36.png" alt="" /></p>

<h4 id="519-anekdootit-osa-1">5.19 anekdootit, osa 1</h4>

<p>Toteuta mahdollisuus anekdoottien äänestämiseen. Äänien määrä tulee tallettaa redux-storeen.</p>

<h4 id="520-anekdootit-osa-2">5.20* anekdootit, osa 2</h4>

<p>Huolehdi siitä, että anekdootit pysyvät äänten mukaisessa suuruusjärjetyksessä.</p>

<h4 id="521-anekdootit-osa-3">5.21* anekdootit, osa 3</h4>

<p>Tee sovellukseen mahdollisuus uusien anekdoottien lisäämiselle.</p>

<h3 id="tehtävien-palautus-5">Tehtävien palautus</h3>

<p>Palauta tehtävät <a href="https://studies.cs.helsinki.fi/fs-stats/">palautussovellukseen</a>.</p>

<h2 id="osa-6">Osa 6</h2>

<p>Deadline 11.3. klo 23:59</p>

<p>Osassa on 23 tehtävää, joista <strong>mikään ei ole pakollinen</strong>. Palautuksen tekemisen jälkeen et voi enää palauttaa osan tehtäviä.</p>

<div class="important">

<p>Ennen kun teet tehtäviä, on enemmän kuin suositeltavaa, että käyt huolellisesti läpi <a href="https://fullstack-hy.github.io/osa6/">osan 6 materiaalin</a>. Tehtävien tekeminen ilman materiaalin lukemista tapahtuu täysin omalla vastuulla.</p>

</div>

<p>Seuraavissa tehtävissä parannellaan edellisen osan anekdoottisovellusta. Ota ratkaisusi pohjaksi repositoriossa <a href="https://github.com/FullStack-HY/redux-anecdotes-v2">https://github.com/FullStack-HY/redux-anecdotes-v2</a> oleva koodi.</p>

<p>Jos kloonaat projektin olemassaolevan git-reposition sisälle, <em>poista kloonatun sovelluksen git-konfiguraatio</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>redux-anecdotes-v2   // eli mene ensin kloonatun repositorion hakemistoon
rm <span class="nt">-rf</span> .git
</code></pre></div></div>

<p>Sovellus käynnistyy normaaliin tapaan, mutta joudut ensin asentamaan sovelluksen riippuvuudet:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm install
npm start
</code></pre></div></div>

<h3 id="yhdistetyt-reducerit">yhdistetyt reducerit</h3>

<h4 id="61-eslint">6.1 ESlint</h4>

<p>Ota projektiin käyttöön ESlint. Määrittele haluamasi kaltainen konfiguraatio.</p>

<h4 id="62-paremmat-anekdootit-osa-1">6.2 paremmat anekdootit, osa 1</h4>

<p>Sovelluksen komponenteissa viitataan suoraan actioneihin:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">AnecdoteForm</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">handleSubmit</span> <span class="o">=</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
    <span class="kd">const</span> <span class="nx">content</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">anecdote</span><span class="p">.</span><span class="nx">value</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">({</span>
      <span class="na">type</span><span class="p">:</span> <span class="s1">'CREATE'</span><span class="p">,</span>
      <span class="nx">content</span>
    <span class="p">})</span>

  <span class="p">}</span>
  <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Tämä ei ole hyvä tapa. Eriytä action-olioiden luominen <a href="https://redux.js.org/basics/actions#action-creators">action creator</a> -funktioihin. Sijoita creatorit tiedostoon <em>src/reducers/anecdoteReducer.js</em>.</p>

<h4 id="63-paremmat-anekdootit-osa-2">6.3 paremmat anekdootit, osa 2</h4>

<p>Sovelluksessa on valmiina komponentin <em>Notification</em> runko:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">Notification</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">style</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">border</span><span class="p">:</span> <span class="s1">'solid'</span><span class="p">,</span>
      <span class="na">padding</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
      <span class="na">borderWidth</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style=</span><span class="si">{</span><span class="nx">style</span><span class="si">}</span><span class="p">&gt;</span>
        render here notification...
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Laajenna komponenttia siten, että se renderöi redux-storeen talletetun viestin, eli renderöitävä komponentti muuttuu muodoon:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">return</span> <span class="p">(</span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">style=</span><span class="si">{</span><span class="nx">style</span><span class="si">}</span><span class="p">&gt;</span>
    <span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">store</span><span class="p">.</span><span class="nx">getState</span><span class="p">()...</span><span class="si">}</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">)</span>
</code></pre></div></div>

<p>Joudut siis muuttamaan/laajentamaan sovelluksen olemassaolevaa reduceria. Tee toiminnallisuutta varten oma reduceri ja siirry käyttämään sovelluksessa yhdistettyä reduceria osan 6 materiaalin tapaan.</p>

<p>Tässä vaiheessa sovelluksen ei vielä tarvitse osata käyttää <em>Notification</em> komponenttia järkevällä tavalla, riittää että sovellus toimii ja näyttää <em>notificationReducerin</em> alkuarvoksi asettaman viestin.</p>

<h4 id="64-paremmat-anekdootit-osa-3">6.4 paremmat anekdootit, osa 3</h4>

<p>Laajenna sovellusta siten, että se näyttää <em>Notification</em>-komponentin avulla viiden sekunnin ajan kun sovelluksessa äänestetään tai luodaan uusia anekdootteja:</p>

<p><img src="http://localhost:4000/assets/teht/37.png" alt="" /></p>

<p>Notifikaation asettamista ja poistamista varten kannattaa kannattaa toteuttaa <a href="https://redux.js.org/basics/actions#action-creators">action creatorit</a>.</p>

<h4 id="65-paremmat-anekdootit-osa-4">6.5 paremmat anekdootit, osa 4</h4>

<p>Toteuta sovellukseen näytettävien muistiinpanojen filtteröiminen</p>

<p><img src="http://localhost:4000/assets/teht/38.png" alt="" /></p>

<p>Säilytä filtterin tila redux storessa, eli käytännössä kannattaa jälleen luoda uusi reduceri ja action creatorit.</p>

<p>Tee filtterin ruudulla näyttämistä varten komponentti <em>Filter</em>. Voit ottaa sen pohjaksi seuraavan</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class Filter extends React.Component <span class="o">{</span>
  handleChange <span class="o">=</span> <span class="o">(</span>event<span class="o">)</span> <span class="o">=&gt;</span> <span class="o">{</span>
    // input-kentän arvo muuttujassa event.target.value
  <span class="o">}</span>
  render<span class="o">()</span> <span class="o">{</span>
    const style <span class="o">=</span> <span class="o">{</span>
      marginBottom: 10
    <span class="o">}</span>

    <span class="k">return</span> <span class="o">(</span>
      &lt;div <span class="nv">style</span><span class="o">={</span>style<span class="o">}&gt;</span>
        filter &lt;input <span class="nv">onChange</span><span class="o">={</span>this.handleChange<span class="o">}</span>/&gt;
      &lt;/div&gt;
    <span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="connect">connect</h3>

<h4 id="66-paremmat-anekdootit-osa-5">6.6 paremmat anekdootit, osa 5</h4>

<p>Sovelluksessa välitetään <em>redux store</em> tällä hetkellä kaikille komponenteille propseina.</p>

<p>Ota käyttöön kirjasto <a href="https://github.com/reactjs/react-redux">react-redux</a> ja muuta komponenttia <em>Notification</em> niin, että se pääsee käsiksi tilaan <em>connect</em>-funktion välityksellä.</p>

<p>Huomaa, että toimiakseen <em>connect</em> edellyttää että sovellukselle on määriteltävä <a href="https://github.com/reactjs/react-redux/blob/master/docs/api.md#provider-store">Provider</a>.</p>

<h4 id="67-paremmat-anekdootit-osa-6">6.7 paremmat anekdootit, osa 6</h4>

<p>Tee sama komponentille <em>Filter</em> ja <em>AnecdoteForm</em>.</p>

<h4 id="68-paremmat-anekdootit-osa-7">6.8 paremmat anekdootit, osa 7</h4>

<p>Muuta myös <em>AnecdoteList</em> käyttämään connectia.</p>

<p>Poista turhaksi staten propseina tapahtuva välittäminen, eli pelkistä <em>App</em> muotoon:</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">App</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Programming anecdotes<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nc">Notification</span> <span class="p">/&gt;</span>
        <span class="p">&lt;</span><span class="nc">AnecdoteForm</span> <span class="p">/&gt;</span>
        <span class="p">&lt;</span><span class="nc">AnecdoteList</span> <span class="p">/&gt;</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="69-paremmat-anekdootit-osa-8">6.9 paremmat anekdootit, osa 8</h4>

<p>Välitä komponentille <em>AnecdoteList</em> connectin avulla ainoastaan yksi stateen liittyvä propsi, filtterin tilan perusteella näytettävät anekdootit samaan tapaan kuin materiaalin luvussa <a href="/osa6/#presentationalcontainer-revisited">Presentational/Container revisited</a>.</p>

<p>Komponentin <em>AnecdoteList</em> metodi <em>render</em> siis typistyy suunnilleen seuraavaan muotoon</p>

<div class="language-react highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">AnecdoteList</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="c1">// ...</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Anecdotes<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nc">Filter</span> <span class="p">/&gt;</span>
        <span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">anecdotesToShow</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">anecdote</span> <span class="o">=&gt;</span>
          <span class="p">&lt;</span><span class="nt">div</span> <span class="na">key=</span><span class="si">{</span><span class="nx">anecdote</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="p">&gt;</span>
            ...
          <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">)</span><span class="si">}</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">)</span>
  <span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="redux-ja-backend">redux ja backend</h3>

<h4 id="610-anekdootit-ja-backend-osa-1">6.10 anekdootit ja backend, osa 1</h4>

<p>Hae sovelluksen käynnistyessä anekdootit json-serverillä toteutetusta backendistä.</p>

<p>Backendin alustavan sisällön saat esim. <a href="https://github.com/FullStack-HY/redux-anecdotes-v2/wiki">täältä</a>.</p>

<h4 id="611-anekdootit-ja-backend-osa-2">6.11 anekdootit ja backend, osa 2</h4>

<p>Muuta uusien anekdoottien luomista siten, että anekdootit talletetaan backendiin.</p>

<h4 id="612-anekdootit-ja-backend-osa-3">6.12 anekdootit ja backend, osa 3</h4>

<p>Muuta myös äänestäminen siten, että anekdootit talletetaan backendiin. Jos teet talletuksen HTTP PUT -operaatiolla, niin muista että joudut korvaamaan tallettaessa koko olion.</p>

<h3 id="thunk">thunk</h3>

<h4 id="613-anekdootit-ja-backend-osa-4">6.13 anekdootit ja backend, osa 4</h4>

<p>Muuta redux-storen alustus tapahtumaan <em>redux-thunk</em>-kirjaston avulla toteutettuun asynkroniseen actioniin.</p>

<h4 id="614-anekdootit-ja-backend-osa-5">6.14 anekdootit ja backend, osa 5</h4>

<p>Muuta myös uuden anekdootin luominen ja äänestäminen tapahtumaan <em>redux-thunk</em>-kirjaston avulla toteutettuihin asynkronisiin actioneihin.</p>

<h4 id="615-anekdootit-ja-backend-osa-6">6.15 anekdootit ja backend, osa 6</h4>

<p>Notifikaatioiden tekeminen on nyt hieman ikävää, sillä se edellyttää kahden actionin tekemistä ja <em>setTimeout</em>-funktion käyttöä:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">notifyWith</span><span class="p">(</span><span class="s2">`you voted '</span><span class="p">${</span><span class="nx">anecdote</span><span class="p">.</span><span class="nx">content</span><span class="p">}</span><span class="s2">'`</span><span class="p">)</span>
<span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">clearNotification</span><span class="p">()</span>
<span class="p">},</span> <span class="mi">10000</span><span class="p">)</span>
</code></pre></div></div>

<p>Tee asynkrooninen action creator, joka mahdollistaa notifikaation antamisen seuraavasti:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">notify</span><span class="p">(</span><span class="s2">`you voted '</span><span class="p">${</span><span class="nx">anecdote</span><span class="p">.</span><span class="nx">content</span><span class="p">}</span><span class="s2">'`</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>

<p>eli ensimmäisenä parametrina on renderöitävä teksti ja toisena notifikaation näyttöaika sekunneissa.</p>

<p>Ota paranneltu notifikaatiotapa käyttöön sovelluksessasi.</p>

<h3 id="router">router</h3>

<p>Jatketaan anekdoottien parissa. Ota seuraaviin tehtäviin pohjaksi repositoriossa <a href="https://github.com/mluukkai/routed-anecdotes">https://github.com/mluukkai/routed-anecdotes</a> oleva reduxiton anekdoottisovellus.</p>

<p>Jos kloonaat projektin olemassaolevan git-reposition sisälle, <em>poista kloonatun sovelluksen git-konfiguraatio</em></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>routed-anecdotes   // eli mene ensin kloonatun repositorion hakemistoon
rm <span class="nt">-rf</span> .git
</code></pre></div></div>

<p>Sovellus käynnistyy normaaliin tapaan, mutta joudut ensin asentamaan sovelluksen riippuvuudet:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm install
npm start
</code></pre></div></div>

<h4 id="616-routed-anecdotes-osa-1">6.16 routed anecdotes, osa 1</h4>

<p>Lisää sovellukseen React Router siten, että <em>Menu</em>-komponentissa olevia linkkejä klikkailemalla saadaan säädeltyä näytettävää näkymää.</p>

<p>Sovelluksen juuressa, eli polulla <em>/</em> näytetään anekdoottien lista:</p>

<p><img src="http://localhost:4000/assets/teht/40.png" alt="" /></p>

<p>Pohjalla oleva <em>Footer</em>-komponentti tulee näyttää aina.</p>

<p>Uuden anekdootin luominen tapahtuu esim. polulla <em>create</em>:</p>

<p><img src="http://localhost:4000/assets/teht/41.png" alt="" /></p>

<p>Huom: jos saat seuraavan virheilmoituksen</p>

<p><img src="http://localhost:4000/assets/teht/39.png" alt="" /></p>

<p>pääset siitä eroon sisällyttämällä kaiken Router-elementin sisälle tulevaan <em>div</em>-elementtiin:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Router&gt;
  &lt;div&gt;
    ...
  &lt;/div&gt;
&lt;/Router&gt;
</code></pre></div></div>

<h4 id="617-routed-anecdotes-osa-2">6.17 routed anecdotes, osa 2</h4>

<p>Toteuta sovellukseen yksittäisen anekdootin tiedot näyttävä näkymä:</p>

<p><img src="http://localhost:4000/assets/teht/42.png" alt="" /></p>

<p>Yksittäisen anekdootin sivulle navigoidaan klikkaamalla anekdootin nimeä</p>

<p><img src="http://localhost:4000/assets/teht/43.png" alt="" /></p>

<h4 id="618-routed-anecdotes-osa-3">6.18 routed anecdotes, osa 3</h4>

<p>Luomislomakkeen oletusarvoinen toiminnallisuus on melko hämmentävä, sillä kun lomakkeen avulla luodaan uusi muistiinpano, mitään ei näytä tapahtuvan.</p>

<p>Paranna toiminnallisuutta siten, että luomisen jälkeen siirrytään automaattisesti kaikkien anekdoottien näkymään <em>ja</em> käyttäjälle näytetään 10 sekunnin ajan onnistuneesta lisäyksestä kertova notifikaatio:</p>

<p><img src="http://localhost:4000/assets/teht/44.png" alt="" /></p>

<h3 id="inline-tyylit">inline-tyylit</h3>

<p>Parannellaan edellisen tehtäväsarjan ulkoasua inlinetyylien avulla.</p>

<h4 id="619-styled-anecdotes-osa-1">6.19 styled anecdotes, osa 1</h4>

<p>Tee notifikaatioista tyylikkäämpi:</p>

<p><img src="http://localhost:4000/assets/teht/45.png" alt="" /></p>

<p>Notifikaatiosi ei tarvitse näyttää samanlaiselta, tyyli on vapaa.</p>

<p>Googlaile tarvittaessa apua. Hyödyllisiä avainsanoja ovat ainakin <em>border</em>, <em>margin</em> ja <em>padding</em>. <a href="https://www.w3schools.com/css/default.asp">w3schoolsin</a> sivulta löytyy paljon esimerkkejä tyyleihin liittyen.</p>

<h4 id="620-styled-anecdotes-osa-2">6.20 styled anecdotes, osa 2</h4>

<p>Paranna menun ulkoasua esim. seuraavasti</p>

<p><img src="http://localhost:4000/assets/teht/46.png" alt="" /></p>

<p>Kuten edellisessä tehtävässä, nytkin tyyli on vapaa.</p>

<p>Jos haluat erotella aktiivisena olevan sivun linkin tyylin menussa, kannattaa vaihtaa käytössä oleva komponentti <a href="https://github.com/ReactTraining/react-router/blob/master/packages/react-router-dom/docs/api/Link.md">Link</a> sen edistyksellisempään versioon, eli komponenttiin <a href="https://github.com/ReactTraining/react-router/blob/master/packages/react-router-dom/docs/api/NavLink.md">NavLink</a>.</p>

<p>NavLink toimii Link-komponentin tavoin mutta sisältää muutamia käteviä lisäominaisuuksia kuten attribuutin <a href="https://github.com/ReactTraining/react-router/blob/master/packages/react-router-dom/docs/api/NavLink.md#activestyle-object">activeStyle</a>, jonka kanssa useimmiten käytetään attribuuttia <a href="https://github.com/ReactTraining/react-router/blob/master/packages/react-router-dom/docs/api/NavLink.md#exact-bool">exact</a>.</p>

<h3 id="ui-framework">UI-framework</h3>

<p>Viimeistele anekdoottisovellus lisäämällä siihen tyylejä Bootstrapin tai jonkun muun UI-frameworkin avulla.</p>

<h4 id="621-styled-anecdotes-osa-3">6.21 styled anecdotes, osa 3</h4>

<p>Ota käyttöön bootstrap (tai valitsemasi framework) ja renderöi anekdoottien lista tyylikkäämmin, esim. bootstrapissa <a href="https://react-bootstrap.github.io/components/list-group/">ListGroup</a>-komponentin tai Semanticissa <a href="https://react.semantic-ui.com/collections/table">Tablen</a> avulla:</p>

<p><img src="http://localhost:4000/images/teht/47b.png" alt="" /></p>

<h4 id="622-styled-anecdotes-osa-4">6.22 styled anecdotes, osa 4</h4>

<p>Tutustu <a href="https://react-bootstrap.github.io/layout/grid/">bootstrapin</a> tai <a href="https://react.semantic-ui.com/collections/grid">semanticin</a> grideihin ja muuta niiden avulla sovelluksen <em>about</em>-sivua siten, että oikeassa reunassa näytetään jonkun kuuluisan tietojenkäsittelijän kuva:</p>

<p><img src="http://localhost:4000/assets/teht/48.png" alt="" /></p>

<h4 id="623-styled-anecdotes-osa-5">6.23 styled anecdotes, osa 5</h4>

<p>Lisää vielä vapaavalintaisia tyylejä valitsemallasi UI frameworkilla. Voit merkata tehtävän, jos käytät aikaa vapaavalitaisten tyylien lisäämiseen noin 30 minuuttia.</p>

<h3 id="tehtävien-palautus-6">Tehtävien palautus</h3>

<p>Palauta tehtävät <a href="https://studies.cs.helsinki.fi/fs-stats/">palautussovellukseen</a>.</p>

<h2 id="osa-7">osa 7</h2>

<p>Deadline 11.3. klo 23:59</p>

<p>Osassa on 23 tehtävää, arvostelussa tehtävien maksimiin tässä osassa lasketaan kuitenkin ainoastaan 15. Tekemällä enemmän kuin 15 tehtävää, voit paikata edellisten osien tekemättä jääneitä tehtäviä.</p>

<p>Tämän osan tehtävissä jatketaan osissa 4 ja 5 tehtyä Bloglist-sovellusta. Suurin osa tämän osan tehtävistä on toisistaan riippumattomia “featureita”, eli tehtäviä ei tarvitse tehdä järjestyksessä, voit jättää osan aivan hyvin toteuttamatta.</p>

<p>Voit ottaa pohjaksi oman sovelluksesi sijaan myös mallivastauksen koodin.</p>

<p><strong>HUOM</strong> jos et ole tehnyt jonkun osan tehtäviä, ei palautussovelluksessa ole linkkiä osan mallivastaukseen. Pääset kuitenkin mallivastaukseen kirjoittamalla linkin suoraan selaimen osoiteriville.</p>

<p>Useimmat tämän osan tehtävistä vaativat olemassaolevan koodin refaktoroimista. Tämä on tilanne käytännössä aina sovelluksia laajennettaessa, eli vaikka refaktorointi voi olla hankalaa ja ikävääkin, on kyseessä oleellinen taito.</p>

<p>Hyvä neuvo niin refaktorointiin kuin uudenkin koodin kirjoittamiseen on <em>pienissä askelissa eteneminen</em>, koodia ei kannata hajottaa totaalisesti refaktorointia tehdessä pitkäksi aikaa, se on käytännössä varma resepti hermojen menettämiseen.</p>

<div class="important">
  Jos aiot tehdä tehtävät 7.8-7.11 eli siirtää sovelluksen tilanhallinnan reduxin vastuulle, saattaa olla helpompi tehdä reduxiin siirtymiseen vaadittava refaktorointi ennen muiden tehtävien tekemistä.
</div>

<h3 id="71-käyttäjien-näkymä">7.1 käyttäjien näkymä</h3>

<p>Tee sovellukseen näkymä, joka näyttää kaikkin käyttäjiin liittyvät perustietot:</p>

<p><img src="http://localhost:4000/assets/teht/53.png" alt="" /></p>

<h3 id="72-yksittäisen-käyttäjän-näkymä-osa-1">7.2 yksittäisen käyttäjän näkymä, osa 1</h3>

<p>Tee sovellukseen yksittäisen käyttäjän näkymä, jolta selviää mm. käyttäjän lisäämät blogit</p>

<p><img src="http://localhost:4000/assets/teht/54.png" alt="" /></p>

<p>Näkymään päästään klikkaamalla nimeä kaikkien käyttäjien näkymästä</p>

<p><img src="http://localhost:4000/assets/teht/55.png" alt="" /></p>

<h3 id="73-yksittäisen-käyttäjän-näkymä-osa-2">7.3 yksittäisen käyttäjän näkymä osa, 2</h3>

<p>Merkkaa tämä tehtävä tehdyksi jos toteuttamasi yksittäisen käyttäjän näkymä toimii oikein myös siinä tilanteessa että menet urliin suoraan tai refreshaat selaimen ollessasi käyttäjän näkymässä.</p>

<h3 id="74-blogin-näkymä">7.4 blogin näkymä</h3>

<p>Toteuta sovellukseen oma näkymä yksittäisille blogeille. Näkymä voi näyttää seuraavalta</p>

<p><img src="http://localhost:4000/assets/teht/49.png" alt="" /></p>

<p>Näkymään päästään klikkaamalla blogin nimeä kaikkien blogien näkymästä</p>

<p><img src="http://localhost:4000/assets/teht/50.png" alt="" /></p>

<p>Tämän tehtävän jälkeen tehtävässä 5.6 toteutettua toiminnallisuutta ei enää tarvita, eli kaikkien blogien näkymässä yksittäisten blogien detaljien ei enää tarvitse avautua klikatessa.</p>

<h3 id="75-navigointi">7.5 navigointi</h3>

<p>Tee sovellukseen navigaatiomenu</p>

<p><img src="http://localhost:4000/assets/teht/56.png" alt="" /></p>

<h3 id="76-kommentit-osa-1">7.6 kommentit, osa 1</h3>

<p>Tee sovellukseen mahdollisuus blogien kommentointiin:</p>

<p><img src="http://localhost:4000/assets/teht/51.png" alt="" /></p>

<p>Kommentit ovat anonyymejä, eli ne eivät liity järjestelmän käyttäjiin.</p>

<p>Tässä tehtävässä riittää, että frontend osaa näyttää blogilla olevat backendin kautta lisätyt kommentit.</p>

<p>Sopiva rajapinta kommentin luomiseen on osoitteeseen <em>api/blogs/:id/comments</em> tapahtuva HTTP POST -pyyntö.</p>

<h3 id="77-kommentit-osa-2">7.7 kommentit, osa 2</h3>

<p>Laajenna sovellusta siten, että kommentointi onnistuu frontendista käsin:</p>

<p><img src="http://localhost:4000/assets/teht/52.png" alt="" /></p>

<h3 id="78-redux-osa-1">7.8 redux, osa 1</h3>

<p>Siirry käyttämään React-komponenttien tilan eli <em>staten</em> sijaan Reduxia.</p>

<p>Muuta tässä tehtävässä notifikaatio käyttämään Reduxia.</p>

<h3 id="79-redux-osa-2">7.9 redux, osa 2</h3>

<p>Siirrä kaikkien käyttäjien tietojen talletus Reduxiin. Varmista, että sekä kaikkien käyttäjien että yksittäisen käyttäjän näkymät toimivat edelleen.</p>

<p>Tässä tehtävässä saattaa olla hyödyksi käyttää metodin <em>mapStateToProps</em> toista parametria
<a href="https://github.com/reactjs/react-redux/blob/master/docs/api.md#inject-todos-of-a-specific-user-depending-on-props">ownPropsia</a> joka on dokumentaation hienoisesta kryptisyydestä huolimatta <a href="https://stackoverflow.com/questions/41198842/what-is-the-use-of-the-ownprops-arg-in-mapstatetoprops-and-mapdispatchtoprops">aika simppeli</a> asia.</p>

<h3 id="710-redux-osa-3">7.10 redux, osa 3</h3>

<p>Siirrä myös blogien tietojen talletus Reduxiin.</p>

<p>Uuden blogin luomislomakkeen tilaa voit halutessasi hallita edelleen reactin tilan avulla.</p>

<p>Tämä ja seuraava osa ovat kohtuullisen työläitä, mutta erittäin opettavaisia.</p>

<h3 id="711-redux-osa-4">7.11 redux, osa 4</h3>

<p>Siirrä myös kirjautuneen käyttäjän tietojen talletus Reduxiin.</p>

<h3 id="712-tyylit-osa-1">7.12 tyylit, osa 1</h3>

<p>Tee sovelluksesi ulkoasusta tyylikkäämpi jotain kurssilla esiteltyä tapaa käyttäen</p>

<h3 id="713-tyylit-osa-2">7.13 tyylit, osa 2</h3>

<p>Jos käytät tyylien lisäämiseen yli tunnin aikaa, merkkaa myös tämä tehtävä tehdyksi.</p>

<h3 id="714-eslint">7.14 ESLint</h3>

<p>Konfiguroi frontend käyttämään Lintiä</p>

<h3 id="715-webpack">7.15 Webpack</h3>

<p>Tee sovellukselle sopiva webpack-konfiguraatio</p>

<h3 id="716-backendin-testaus">7.16 backendin testaus</h3>

<p>Tee backendille lisää testejä. Voit merkitä rastin kun olet käyttänyt testien tekemiseen noin 45 minuuttia.</p>

<h3 id="717-frontendin-testaus">7.17 frontendin testaus</h3>

<p>Tee frontendille tai reducereille testejä. Voit merkitä rastin kun olet käyttänyt testien tekemiseen noin 45 minuuttia.</p>

<h3 id="718-snapshot-testaus">7.18 snapshot-testaus</h3>

<p>Ota sovellukseessasi käyttöön <a href="https://facebook.github.io/jest/docs/en/snapshot-testing.html">snapshot testing</a></p>

<h3 id="719-headless-testaus">7.19 headless-testaus</h3>

<p>Tee Puppeteeria tai haluamaasi kirjastoa käyttäviä headless-testejä, testaa ainakin paria toiminnallisuutta.</p>

<h3 id="720-tyyppitarkastuksia">7.20 Tyyppitarkastuksia</h3>

<p>Lisää sovellukseen tyyppitarkastuksia Proptypeinä, Flown avulla tai Typescriptillä</p>

<h3 id="721-internet">7.21 Internet</h3>

<p>Deployaa sovellus internetiin</p>

<h3 id="722-jatkuva-tuotantoonvienti">7.22 Jatkuva tuotantoonvienti</h3>

<p>Toteuta sovelluksellesi esim. <a href="https://travis-ci.org/">Travis CI</a>:n avulla jatkuva tuotantoonvienti, eli mekanismi, missä koodin pushaaminen githubiin aiheuttaa testien läpimennessä uuden version käynnistämisen internettiin.</p>

<h3 id="723-kurssipalaute">7.23 Kurssipalaute</h3>

<p>Anna kurssille palautetta osoitteessa <a href="https://ilmo.cs.helsinki.fi/kurssit/servlet/Valinta">https://ilmo.cs.helsinki.fi/kurssit/servlet/Valinta</a></p>

<h3 id="tehtävien-palautus-7">Tehtävien palautus</h3>

<p>Palauta tehtävät <a href="https://studies.cs.helsinki.fi/fs-stats/">palautussovellukseen</a>.</p>

  </div>

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading"></h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
             Full stack open 2018 
          </li>
          <li>
            <a href="mailto:mluukkai@cs.helsinki.fi">mluukkai@cs.helsinki.fi</a>
          </li>
          <li>
            <a href="https://github.com/mluukkai"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">mluukkai</span></a>

          </li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
           
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>
        <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">
          <img alt="Creative Commons -lisenssi" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png"
          />
        </a>
        <br />Materiaali on lisensoitu
        <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons BY-NC-SA 3.0 -lisenssillä</a>.
        </p>
      </div>
    </div>

  </div>

</footer>

  </body>

</html>
